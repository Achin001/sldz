(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["designerModuleConfig10"],{"02f4e":function(e,t,n){"use strict";n("39e2")},"1ca6":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-kit"},[e.scriptConfig.event&&e.scriptConfig.event.length>0?n("a-collapse",{attrs:{"default-active-key":"0",bordered:!1},model:{value:e.panelActiveKey,callback:function(t){e.panelActiveKey=t},expression:"panelActiveKey"}},[e._l(e.scriptConfig.event,(function(t,i){return[n("a-collapse-panel",{key:"event_panel_"+i,staticStyle:{"padding-left":"0"},attrs:{header:"@"+t.key+"("+t.params.map((function(e){return e.key})).join(", ")+")"}},[n("a-row",[n("a-col",{attrs:{span:18,offset:2}},[n("a-switch",{attrs:{"checked-children":"启用","un-checked-children":"未启用"},model:{value:t.open,callback:function(n){e.$set(t,"open",n)},expression:"eve.open"}})],1)],1),t.open?n("a-popover",{attrs:{placement:"left",title:"@"+t.key+" 事件绑定",trigger:"click"}},[n("div",{staticStyle:{width:"600px",height:"400px"},attrs:{slot:"content"},slot:"content"},[n("smart-code-editor",{attrs:{code:e.code,workspace:e.workspace,"param-value-getter":function(n){return e.paramValueGetter(n,t.params,t.handlerCode)}},on:{input:function(n){return e.onHandlerCodeChange(n,t)}},model:{value:t.handlerCode,callback:function(n){e.$set(t,"handlerCode",n)},expression:"eve.handlerCode"}})],1),n("a-button",{staticStyle:{margin:"10px 0"},attrs:{block:"",type:"primary",size:"small"}},[e._v("\n            编辑事件函数\n          ")])],1):e._e()],1)]}))],2):[e._v("\n    无\n  ")]],2)},l=[],a=(n("28a5"),n("4917"),n("788b")),o=n("541c"),s={name:"EventKit",data:function(){return{panelActiveKey:"event_panel_0"}},methods:{paramValueGetter:function(e,t,n){var i="";if(t&&t.length>0&&n){for(var l,a=0;a<t.length;a++)if(t[a].type===e.type){l=a;break}if(void 0===l)return"";var o=/[^(][a-zA-Z0-9]+(?=\))/,s=n.match(o);if(0===!s.length)return"";var r=s[0].split(",");if(r.length<=l)return"";i=r[l].trim()}return i},onHandlerCodeChange:function(e,t){t.handlerFuncName=Object(o["a"])(e)}},components:{smartCodeEditor:a["a"]},props:{workspace:{type:String,default:"panelDesigner"},code:{type:String,default:""},scriptConfig:{type:Object,default:function(){return{}}},extraMethodObjList:{type:Array,default:function(){return[]}}}},r=s,u=(n("8d31"),n("2877")),c=Object(u["a"])(r,i,l,!1,null,"00f37324",null);t["a"]=c.exports},"2b5a":function(e,t,n){},"2f35":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form",{attrs:{layout:"horizontal"}},[n("h3",{staticClass:"title separator"},[e._v("列表复选框设置")]),n("a-row",[n("a-col",{attrs:{span:22}},[n("a-radio-group",{attrs:{size:"small","default-value":"NONE","button-style":"solid"},on:{change:e.onRowSelectionChanged},model:{value:e.moduleConfig.metadata.rowSelection,callback:function(t){e.$set(e.moduleConfig.metadata,"rowSelection",t)},expression:"moduleConfig.metadata.rowSelection"}},[n("a-radio-button",{attrs:{value:"NONE"}},[e._v("\n          无\n        ")]),n("a-radio-button",{attrs:{value:"MULTI_SELECT"}},[e._v("\n          多选\n        ")])],1)],1)],1),n("h3",{staticClass:"title separator"},[e._v("固定操作栏")]),n("a-row",[n("a-col",{attrs:{span:22}},[n("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否"},model:{value:e.moduleConfig.metadata.fixAction,callback:function(t){e.$set(e.moduleConfig.metadata,"fixAction",t)},expression:"moduleConfig.metadata.fixAction"}})],1)],1),n("column-list-selector-plus",{attrs:{"primary-key-event":!0,"need-ref-entity":!1,"is-expand":!1,"valid-columns-filter":e.validColumnsFilter,title:"列表项配置","vo-type":"ListVO"},on:{change:function(t){e.moduleConfig.metadata.columns=e._.cloneDeep(t)},primaryKeyChange:function(t){e.moduleConfig.metadata.primaryKey=t}}})],1)},l=[],a=(n("7514"),n("e5b5")),o=n("4047"),s={name:"TableListConfig",data:function(){return{}},methods:{onRowSelectionChanged:function(e){if("NONE"===e)this.moduleConfig.scriptConfig.data&&this.moduleConfig.scriptConfig.data.length>0&&(this.moduleConfig.scriptConfig.data=this.moduleConfig.scriptConfig.data.filter((function(e){return"selectedRowKeys"!==e.key})));else{var t=this.moduleConfig.scriptConfig.data.find((function(e){return"selectedRowKeys"===e.key}));void 0===t&&this.moduleConfig.scriptConfig.data.push({key:"selectedRowKeys",name:"选中ID列表",type:"Array"})}},validColumnsFilter:function(e){return"id"!==e.fieldName&&"uuid"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&"S_FILE_UPLOAD"!==e.columnExt.formType&&"M_FILE_UPLOAD"!==e.columnExt.formType&&"S_IMG_UPLOAD"!==e.columnExt.formType&&"M_IMG_UPLOAD"!==e.columnExt.formType&&"RICH_EDITOR"!==e.columnExt.formType&&!e.columnExt.refType}},mixins:[a["a"]],components:{columnListSelectorPlus:o["a"]}},r=s,u=(n("ab80"),n("2877")),c=Object(u["a"])(r,i,l,!1,null,"15a30428",null);t["default"]=c.exports},"39e2":function(e,t,n){},4047:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h3",{staticClass:"title separator"},[e._v("\n    "+e._s(e.title)+"\n    "),n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",ghost:"",size:"small",title:"更改所有的显示标签",icon:"edit"},on:{click:e.showAllEdit}})],1),[e.resultColumns?n("draggable",{attrs:{element:"div",handle:".drag-handle",options:{group:{name:"columns",pull:"false",put:!1},sort:!0,forceFallback:!0}},model:{value:e.resultColumns,callback:function(t){e.resultColumns=t},expression:"resultColumns"}},e._l(e.resultColumns,(function(t,i){return n("div",{key:i,staticClass:"row-container"},[n("a-row",{staticClass:"config-form-item"},[n("a-col",{attrs:{span:2}},[n("span",{staticClass:"col-icon-span drag-handle",attrs:{title:"拖拽可排序"}},[n("a-icon",{staticStyle:{fontSize:"20px"},attrs:{type:"bars"}})],1)]),n("a-col",{attrs:{span:e._f("anotherColSpan")(e._f("btnColSpan")(4,t,e.isExpand,e.expandColumnsFilter),2)}},[t.showInput?n("a-input",{attrs:{id:e.voType+"FieldNameEditInput_"+t.fieldName,size:"small"},on:{keyup:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.saveEdit(t)},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:e.cancelEdit(t)}]},model:{value:t.editFieldLabel,callback:function(n){e.$set(t,"editFieldLabel",n)},expression:"col.editFieldLabel"}},[n("template",{slot:"addonAfter"},[n("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"close",title:"关闭"},on:{click:function(n){return e.cancelEdit(t)}}}),n("a-divider",{attrs:{type:"vertical"}}),n("a-icon",{staticStyle:{color:"#2198f7",cursor:"pointer"},attrs:{type:"check",title:"保存"},on:{click:function(n){return e.saveEdit(t)}}})],1)],2):n("p",{staticClass:"icon-small-line"},[n("span",{staticStyle:{"padding-right":"2px"}},[e._v("\n                "+e._s(t.fieldLabel)+"\n              ")]),"BindEntity"===t.refCodeType?n("a-tag",{attrs:{color:"cyan"}},[e._v("\n                对象.字段\n              ")]):e._e(),"BindFieldList"===t.refCodeType?n("a-tag",{attrs:{color:"blue"}},[e._v("\n                对象字段列表\n              ")]):e._e()],1)],1),n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:e._f("btnColSpan")(4,t,e.isExpand,e.expandColumnsFilter)}},[t.showInput?e._e():n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",size:"small",title:"更改该项显示标签",icon:"edit"},on:{click:function(n){return e.showEdit(t)}}}),e.isExpand&&(void 0===e.expandColumnsFilter||e.expandColumnsFilter(t))?n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",size:"small",title:t.expand?"收起":"展开",icon:t.expand?"up":"down"},on:{click:function(n){return e.toggleColExpand(t)}}}):e._e(),n("a-button",{staticStyle:{color:"#f36e70"},attrs:{type:"link",size:"small",title:"删除该项",icon:"delete"},on:{click:function(t){return e.removeColumn(i)}}})],1)],1),t.expand?[n("div",{staticClass:"expand-container"},[e._t("item-extra-content",null,{col:t,index:i})],2)]:e._e()],2)})),0):e._e(),n("a-row",[n("a-col",{attrs:{span:"22"}},[e.selectColumns.length>0?n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","filter-option":e.filterOption,placeholder:"请选择搜索字段"},on:{change:function(t){return e.addColumn(t)}},model:{value:e.addFieldName,callback:function(t){e.addFieldName=t},expression:"addFieldName"}},e._l(e.selectColumns,(function(t,i){return n("a-select-option",{key:i,attrs:{value:t.fieldName}},[e._v("\n            "+e._s(t.fieldLabel)+"["+e._s(t.fieldName)+"]\n          ")])})),1):e._e()],1)],1)]],2)},l=[],a=(n("6762"),n("2fdb"),n("ac6a"),n("75fc")),o=(n("7514"),n("2ef0")),s=n.n(o),r=n("3aa3"),u=n("310e"),c=n.n(u),d={name:"ColumnListSelectorPlus",data:function(){return{resultColumns:[],validColumns:[],addFieldName:void 0,showAllEditFlag:!1}},methods:{initPrimaryKey:function(){if(!this.primaryKeyEvent||!this.columns||0===this.columns.length)return!1;var e=this.columns.find((function(e){return!0===e.primaryKey})),t=void 0===e?"id":e.fieldName;this.$emit("primaryKeyChange",t)},initValidColumns:function(){var e=this;if(this.columns&&this.columns.length>0){var t=this.columns;if(void 0!==this.validColumnsFilter&&(t=this.columns.filter(this.validColumnsFilter)),this.validColumns=s.a.cloneDeep(t),this.appendOtherProperties(this.validColumns),this.voType){var n=this.columns[0]["tableName"];r["a"].get("/diboot/devtools/pcDesigner/getVoRefList/".concat(n,"/").concat(this.voType)).then((function(t){if(0===t.code&&t.data){var n,i=t.data.filter((function(e){return"BindEntity"!==e.refCodeType&&"BindEntityList"!==e.refCodeType}));if(e.appendOtherProperties(i),(n=e.validColumns).push.apply(n,Object(a["a"])(i)),e.value.length>0?e.resultColumns=s.a.cloneDeep(e.value):e.resultColumns=s.a.cloneDeep(e.validColumns),e.needRefEntity){var l,o=t.data.filter((function(e){return"BindEntity"===e.refCodeType&&void 0!==e.columns&&e.columns.length>0})),r=[];o.forEach((function(e){var t=e.columns.filter((function(e){return"id"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&!e.columnExt.refType})),n=t.map((function(t){return t.fieldName="".concat(e.fieldName,".").concat(t.fieldName),t.fieldLabel="".concat(e.fieldLabel).concat(t.fieldLabel),t.refCodeType=e.refCodeType,t.entityFieldName=e.fieldName,t}));r.push.apply(r,Object(a["a"])(n))})),e.appendOtherProperties(r),(l=e.validColumns).push.apply(l,r)}}else e.value.length>0?e.resultColumns=s.a.cloneDeep(e.value):e.resultColumns=s.a.cloneDeep(e.validColumns)})).catch((function(){e.value.length>0?e.resultColumns=s.a.cloneDeep(e.value):e.resultColumns=s.a.cloneDeep(e.validColumns)}))}else this.value.length>0?this.resultColumns=s.a.cloneDeep(this.value):this.resultColumns=s.a.cloneDeep(this.validColumns)}},addColumn:function(e){var t=this.validColumns.find((function(t){return t.fieldName===e}));if(void 0===t)return!1;this.addFieldName=void 0,this.resultColumns.push(t),this.$emit("change",this.resultColumns)},toggleColExpand:function(e){e.expand=!e.expand},removeColumn:function(e){var t=this.resultColumns.splice(e,1);if(t.length>0){var n=t[0],i=this.validColumns.find((function(e){return e.colName===n.colName}));if(void 0!==i){var l=this.validColumns.indexOf(i);-1!==l&&(this.validColumns[l]=n)}}this.$emit("change",this.resultColumns)},appendOtherProperties:function(e){var t=this;e.forEach((function(e){e.showInput=!1,e.expand=!1,e.editFieldLabel=e.fieldLabel,void 0!==t.colExtraPropertiesSetter&&t.colExtraPropertiesSetter(e)}))},showAllEdit:function(){var e=this;this.showAllEditFlag=!this.showAllEditFlag,this.resultColumns&&this.resultColumns.map((function(t){e.showAllEditFlag?t.showInput=!0:e.cancelEdit(t)}))},showEdit:function(e){var t=this;e.showInput=!0,setTimeout((function(){var n=document.getElementById("".concat(t.voType,"FieldNameEditInput_").concat(e.fieldName));n&&n.focus()}),200)},cancelEdit:function(e){e.editFieldLabel=e.fieldLabel,e.showInput=!1,this.focusNextColumn(e)},saveEdit:function(e){if(!e.editFieldLabel)return this.$message.error("字段标签名称不可为空"),!1;e.fieldLabel=e.editFieldLabel,e.showInput=!1,this.$emit("change",this.resultColumns),this.$forceUpdate(),this.focusNextColumn(e)},focusNextColumn:function(e){var t=this.resultColumns.indexOf(e)+1;if(t>0&&t<this.resultColumns.length){var n=this.resultColumns[t];n.showInput?document.getElementById("".concat(this.voType,"FieldNameEditInput_").concat(n.fieldName)).focus():this.focusNextColumn(n)}},changed:function(){this.$emit("change",this.resultColumns)},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}},filters:{btnColSpan:function(e,t,n,i){return e=e||4,n&&(e+=2),void 0===i||i(t)||(e-=2),t.showInput||(e+=2),e},anotherColSpan:function(e,t){return 24-e-t}},computed:{columns:function(){return this.initColumns?this.initColumns:this.$store.state.database.columns},selectColumns:function(){if(void 0===this.resultColumns)return[];var e=this.resultColumns.map((function(e){return e.fieldName}));return this.validColumns.filter((function(t){return!e.includes(t.fieldName)}))}},watch:{columns:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()},resultColumns:{handler:function(e){this.$emit("change",e)},deep:!0}},components:{draggable:c.a},props:{title:{type:String,default:"数据项配置"},isExpand:{type:Boolean,default:!0},voType:{type:String,default:""},value:{type:Array,default:function(){return[]}},colExtraPropertiesSetter:{type:Function,default:function(){}},expandColumnsFilter:{type:Function,default:void 0},validColumnsFilter:{type:Function,default:void 0},needRefEntity:{type:Boolean,default:!0},initColumns:{type:Array,default:void 0},primaryKeyEvent:{type:Boolean,default:!1}},created:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()}},f=d,m=(n("ea8f"),n("2877")),p=Object(m["a"])(f,i,l,!1,null,"8f19bbea",null);t["a"]=p.exports},5381:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("a-form-model",{ref:"configForm",attrs:{model:e.moduleConfig.metadata,layout:"horizontal",rules:e.rules}},[n("h3",{staticClass:"title separator"},[e._v("基础配置")]),n("a-form-model-item",{attrs:{label:"布局列数",labelCol:{span:8},wrapperCol:{span:12}}},[n("a-input-number",{staticStyle:{width:"100%"},attrs:{min:1,max:10,placeholder:"请输入布局列数"},model:{value:e.moduleConfig.metadata.colNumber,callback:function(t){e.$set(e.moduleConfig.metadata,"colNumber",t)},expression:"moduleConfig.metadata.colNumber"}})],1),e.listTables.length>0?[n("h3",{staticClass:"title separator"},[e._v("数据实体配置")]),n("a-row",[n("a-col",{attrs:{span:22}},[n("a-form-model-item",{ref:"tableName",attrs:{prop:"tableName"}},[n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","filter-option":e.filterOption,"default-value":e.listTables[e.listTables.length-1]["tableName"]},on:{change:e.listTableNameChanged},model:{value:e.moduleConfig.metadata.tableName,callback:function(t){e.$set(e.moduleConfig.metadata,"tableName",t)},expression:"moduleConfig.metadata.tableName"}},e._l(e.listTables,(function(t,i){return n("a-select-option",{key:i,attrs:{value:t.tableName}},[e._v("\n              "+e._s(t.objName)+" ["+e._s(t.tableName)+"]\n            ")])})),1)],1)],1)],1)]:e._e(),e.listColumns.length>0?n("column-list-selector",{attrs:{value:e.moduleConfig.metadata.listColumns,title:"显示字段配置","init-columns":e.listColumns,"valid-columns-filter":e.validListColumnsFilter,"vo-type":"ListVO"},on:{change:function(t){e.moduleConfig.metadata.listColumns=e._.cloneDeep(t)}}}):e._e()],2)},l=[],a=(n("ac6a"),n("7514"),n("7f57")),o=n("6cc4"),s=n("8656"),r=n("3aa3"),u={name:"TimelineConfig",data:function(){return{listTables:[],treeColumns:[],listColumns:[],rules:{tableName:[{required:!0,message:"请选择列表实体配置",trigger:"blur"}]}}},methods:{startConfigValidate:function(e){var t=this;console.log("refs configForm",this.$refs.configForm),this.$refs.configForm.validate((function(n,i){if(n)e();else{var l=t.collectErrMsg(i);e(l)}}))},listTableNameChanged:function(e){var t=this.listTables.find((function(t){return t.tableName===e}));this.moduleConfig.metadata.listTable=t,this.getListColumns(e)},getListColumns:function(e){var t=this;this.listColumns=[],r["a"].get("/diboot/devtools/db/columns/".concat(e)).then((function(e){0===e.code&&(t.moduleConfig.metadata.listColumns=[],e.data.forEach((function(e){e.columnExt||(e.columnExt={})})),t.listColumns=e.data)}))},validListColumnsFilter:function(e){return"id"!==e.fieldName&&"uuid"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&!e.columnExt.refType}},mixins:[a["a"],s["a"]],components:{columnListSelector:o["a"]},mounted:function(){this.$nextTick((function(){var e=this;r["a"].get("/diboot/devtools/db/onlyEditableTables").then((function(t){if(0===t.code&&(e.listTables=t.data,e.listTables.length>0)){var n=e.listTables[0].tableName;try{e.moduleConfig.metadata.tableName?n=e.moduleConfig.metadata.tableName:e.moduleConfig.metadata.tableName=n}catch(i){console.log("通用列表获取当前表名出错",n)}e.listTableNameChanged(n)}}))}))}},c=u,d=(n("ccbc"),n("2877")),f=Object(d["a"])(c,i,l,!1,null,"3b1b7c2d",null);t["default"]=f.exports},"541c":function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));n("28a5");var i=function(e){if(!e)return"";var t=e.slice(0,e.indexOf("(")).split(" ");return 1===t.length?t[0].trim():t[t.length-1].trim()}},"6cc4":function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("h3",{staticClass:"title separator"},[e._v("\n    "+e._s(e.title)+"\n    "),n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",ghost:"",size:"small",title:"更改所有的显示标签",icon:"edit"},on:{click:e.showAllEdit}})],1),[e.resultColumns?n("draggable",{attrs:{element:"div",handle:".drag-handle",options:{group:{name:"columns",pull:"false",put:!1},sort:!0,forceFallback:!0}},model:{value:e.resultColumns,callback:function(t){e.resultColumns=t},expression:"resultColumns"}},e._l(e.resultColumns,(function(t,i){return n("a-row",{key:i,staticClass:"config-form-item"},[n("a-col",{attrs:{span:2}},[n("span",{staticClass:"col-icon-span drag-handle",attrs:{title:"拖拽可排序"}},[n("a-icon",{staticStyle:{fontSize:"20px"},attrs:{type:"bars"}})],1)]),n("a-col",{attrs:{span:t.showInput?18:16}},[t.showInput?n("a-input",{attrs:{id:e.voType+"FieldNameEditInput_"+t.fieldName,size:"small"},on:{keyup:[function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.saveEdit(t)},function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:e.cancelEdit(t)}]},model:{value:t.editFieldLabel,callback:function(n){e.$set(t,"editFieldLabel",n)},expression:"col.editFieldLabel"}},[n("template",{slot:"addonAfter"},[n("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"close",title:"关闭"},on:{click:function(n){return e.cancelEdit(t)}}}),n("a-divider",{attrs:{type:"vertical"}}),n("a-icon",{staticStyle:{color:"#2198f7",cursor:"pointer"},attrs:{type:"check",title:"保存"},on:{click:function(n){return e.saveEdit(t)}}})],1)],2):n("p",{staticClass:"icon-small-line"},[n("span",{staticStyle:{"padding-right":"2px"}},[e._v("\n              "+e._s(t.fieldLabel)+"\n            ")]),"BindEntity"===t.refCodeType?n("a-tag",{attrs:{color:"cyan"}},[e._v("\n              对象.字段\n            ")]):e._e(),"BindFieldList"===t.refCodeType?n("a-tag",{attrs:{color:"blue"}},[e._v("\n              对象字段列表\n            ")]):e._e()],1)],1),n("a-col",{attrs:{span:t.showInput?4:6}},[t.showInput?e._e():n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",size:"small",title:"更改该项显示标签",icon:"edit"},on:{click:function(n){return e.showEdit(t)}}}),n("a-button",{staticStyle:{color:"#f36e70"},attrs:{type:"link",size:"small",title:"删除该项",icon:"delete"},on:{click:function(t){return e.removeColumn(i)}}})],1)],1)})),1):e._e(),n("a-row",[n("a-col",{attrs:{span:"22"}},[e.selectColumns.length>0?n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","filter-option":e.filterOption,placeholder:"请选择搜索字段"},on:{change:function(t){return e.addColumn(t)}},model:{value:e.addFieldName,callback:function(t){e.addFieldName=t},expression:"addFieldName"}},e._l(e.selectColumns,(function(t,i){return n("a-select-option",{key:i,attrs:{value:t.fieldName}},[e._v("\n            "+e._s(t.fieldLabel)+"["+e._s(t.fieldName)+"]\n          ")])})),1):e._e()],1)],1)]],2)},l=[],a=(n("6762"),n("2fdb"),n("ac6a"),n("75fc")),o=(n("7514"),n("2ef0")),s=n.n(o),r=n("3aa3"),u=n("310e"),c=n.n(u),d={name:"ColumnListSelector",data:function(){return{resultColumns:[],validColumns:[],addFieldName:void 0,showAllEditFlag:!1}},methods:{initPrimaryKey:function(){if(!this.primaryKeyEvent||!this.columns||0===this.columns.length)return!1;var e=this.columns.find((function(e){return!0===e.primaryKey})),t=void 0===e?"id":e.fieldName;this.$emit("primaryKeyChange",t)},initValidColumns:function(){var e=this;if(this.columns&&this.columns.length>0){var t=this.columns;if(void 0!==this.validColumnsFilter&&(t=this.columns.filter(this.validColumnsFilter)),this.validColumns=s.a.cloneDeep(t),this.appendEditConfig(this.validColumns),this.voType){var n=this.columns[0]["tableName"];r["a"].get("/diboot/devtools/pcDesigner/getVoRefList/".concat(n,"/").concat(this.voType)).then((function(t){if(0===t.code&&t.data){var n,i=t.data.filter((function(e){return"BindEntity"!==e.refCodeType&&"BindEntityList"!==e.refCodeType}));if(e.appendEditConfig(i),(n=e.validColumns).push.apply(n,Object(a["a"])(i)),e.value.length>0?e.resultColumns=s.a.cloneDeep(e.value):e.resultColumns=s.a.cloneDeep(e.validColumns),e.needRefEntity){var l,o=t.data.filter((function(e){return"BindEntity"===e.refCodeType&&void 0!==e.columns&&e.columns.length>0})),r=[];o.forEach((function(e){var t=e.columns.filter((function(e){return"id"!==e.fieldName&&"isDeleted"!==e.fieldName&&"extdata"!==e.fieldName&&!e.columnExt.refType})),n=t.map((function(t){return t.fieldName="".concat(e.fieldName,".").concat(t.fieldName),t.fieldLabel="".concat(e.fieldLabel).concat(t.fieldLabel),t.refCodeType=e.refCodeType,t.entityFieldName=e.fieldName,t}));r.push.apply(r,Object(a["a"])(n))})),e.appendEditConfig(r),(l=e.validColumns).push.apply(l,r)}}else e.value.length>0?e.resultColumns=s.a.cloneDeep(e.value):e.resultColumns=s.a.cloneDeep(e.validColumns)})).catch((function(){e.value.length>0?e.resultColumns=s.a.cloneDeep(e.value):e.resultColumns=s.a.cloneDeep(e.validColumns)}))}else this.value.length>0?this.resultColumns=s.a.cloneDeep(this.value):this.resultColumns=s.a.cloneDeep(this.validColumns)}},addColumn:function(e){var t=this.validColumns.find((function(t){return t.fieldName===e}));if(void 0===t)return!1;this.addFieldName=void 0,this.resultColumns.push(t),this.$emit("change",this.resultColumns)},removeColumn:function(e){var t=this.resultColumns.splice(e,1);if(t.length>0){var n=t[0],i=this.validColumns.find((function(e){return e.colName===n.colName}));if(void 0!==i){var l=this.validColumns.indexOf(i);-1!==l&&(this.validColumns[l]=n)}}this.$emit("change",this.resultColumns)},appendEditConfig:function(e){e.forEach((function(e){e.showInput=!1,e.editFieldLabel=e.fieldLabel}))},showAllEdit:function(){var e=this;this.showAllEditFlag=!this.showAllEditFlag,this.resultColumns&&this.resultColumns.map((function(t){e.showAllEditFlag?t.showInput=!0:e.cancelEdit(t)}))},showEdit:function(e){var t=this;e.showInput=!0,setTimeout((function(){document.getElementById("".concat(t.voType,"FieldNameEditInput_").concat(e.fieldName)).focus()}),200)},cancelEdit:function(e){e.editFieldLabel=e.fieldLabel,e.showInput=!1,this.focusNextColumn(e)},saveEdit:function(e){if(!e.editFieldLabel)return this.$message.error("字段标签名称不可为空"),!1;e.fieldLabel=e.editFieldLabel,e.showInput=!1,this.$emit("change",this.resultColumns),this.focusNextColumn(e)},focusNextColumn:function(e){var t=this.resultColumns.indexOf(e)+1;if(t>0&&t<this.resultColumns.length){var n=this.resultColumns[t];n.showInput?document.getElementById("".concat(this.voType,"FieldNameEditInput_").concat(n.fieldName)).focus():this.focusNextColumn(n)}},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}},computed:{columns:function(){return this.initColumns?this.initColumns:this.$store.state.database.columns},selectColumns:function(){if(void 0===this.resultColumns)return[];var e=this.resultColumns.map((function(e){return e.fieldName}));return this.validColumns.filter((function(t){return!e.includes(t.fieldName)}))}},watch:{columns:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()},resultColumns:function(e){this.$emit("change",e)}},components:{draggable:c.a},props:{title:{type:String,default:"数据项配置"},voType:{type:String,default:""},value:{type:Array,default:function(){return[]}},validColumnsFilter:{type:Function,default:void 0},needRefEntity:{type:Boolean,default:!0},initColumns:{type:Array,default:void 0},primaryKeyEvent:{type:Boolean,default:!1}},created:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()}},f=d,m=(n("02f4e"),n("2877")),p=Object(m["a"])(f,i,l,!1,null,"7efc04e3",null);t["a"]=p.exports},7201:function(e,t,n){},"7f57":function(e,t,n){"use strict";n("8e6e"),n("ac6a"),n("456d");var i=n("bd86"),l=n("2ef0"),a=n.n(l),o=n("1ca6"),s=n("2f62"),r=n("80da");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=Object(s["a"])("panelDesigner"),f=d.mapMutations;t["a"]={data:function(){return{workspace:"panelDesigner"}},methods:c(c({},f(["updateModuleConfigList","updateConfigMap"])),{},{filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}}),computed:{moduleConfig:{get:function(){var e=this.$store.state.panelDesigner[this.code].moduleConfigMap;return e[this.uuid]},set:function(e){var t=this.$store.state.panelDesigner[this.code].moduleConfigMap;t[this.uuid];a.a.cloneDeep(e),this.updateConfigMap({key:this.code,configMap:t})}}},components:{eventKit:o["a"]},mixins:[r["a"]],props:{uuid:{type:String,required:!0},code:{type:String,required:!0},projectType:{type:String,required:!0}}}},8656:function(e,t,n){"use strict";n("8e6e"),n("456d");var i=n("75fc"),l=(n("ac6a"),n("bd86")),a=(n("6762"),n("2fdb"),n("2f62"));function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){Object(l["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t["a"]={methods:{hasPermission:function(e){return 0===this.actionList.length||this.actionList.includes(e)}},computed:s(s({},Object(a["f"])({mainLevel:function(e){return e.user.mainLevel}})),{},{actionList:function(){if(!this.mainLevel||!this.mainLevel.permissions||0===this.mainLevel.permissions.length)return[];var e=[];return this.mainLevel.permissions.forEach((function(t){t.actionList&&t.actionList.length>0&&e.push.apply(e,Object(i["a"])(t.actionList))})),e}})}},"8d31":function(e,t,n){"use strict";n("9913")},9913:function(e,t,n){},ab80:function(e,t,n){"use strict";n("2b5a")},bbd5:function(e,t,n){},ccbc:function(e,t,n){"use strict";n("bbd5")},e5b5:function(e,t,n){"use strict";n("8e6e"),n("ac6a"),n("456d");var i=n("bd86"),l=n("2ef0"),a=n.n(l),o=n("2f62"),s=n("1ca6"),r=n("80da");function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){Object(i["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=Object(o["a"])("DragConfig"),f=d.mapMutations;t["a"]={data:function(){return{workspace:"DragConfig"}},methods:c({},f(["updateModuleConfigList","updateConfigMap"])),computed:{moduleConfig:{get:function(){var e=this.$store.state.DragConfig[this.code].moduleConfigMap;return e[this.uuid]},set:function(e){var t=this.$store.state.DragConfig[this.code].moduleConfigMap;t[this.uuid];a.a.cloneDeep(e),this.updateConfigMap({key:this.code,configMap:t})}}},components:{eventKit:s["a"]},mixins:[r["a"]],props:{uuid:{type:String,required:!0},code:{type:String,required:!0},projectType:{type:String,required:!0}}}},ea8f:function(e,t,n){"use strict";n("7201")}}]);