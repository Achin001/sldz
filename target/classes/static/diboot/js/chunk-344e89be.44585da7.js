(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-344e89be"],{"01e0":function(e,t,n){},1248:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("draggable",{staticClass:"module-screen",class:{root:"root"===e.type,null:!e.targetList||0===e.targetList.length,preview:"preview"===e.code},attrs:{element:"div","ghost-class":"sortable-ghost",animation:340,options:{group:{name:e.disabled?"preview":"compgroup",pull:!1},sort:!e.disabled}},on:{add:e.addModule},model:{value:e.targetList,callback:function(t){e.targetList=t},expression:"targetList"}},e._l(e.targetList,(function(t,i){return n("div",{key:t.uuid,staticClass:"component-box",class:{current:e.currentModule.uuid===t.uuid}},[e.disabled?[t.uuid?n(e.componentMap[t.mark],{directives:[{name:"show",rawName:"v-show",value:void 0===t.hidden||!t.hidden,expression:"item.hidden === undefined || !item.hidden"}],tag:"component",staticClass:"preview-element",class:{current:e.currentModule.uuid===t.uuid},attrs:{uuid:t.uuid,"project-type":e.projectType,code:e.code},on:{click:function(n){return e.changeCurrentModule(n,t)}}}):e._e()]:[t.uuid?n(e.componentMap[t.mark],{directives:[{name:"show",rawName:"v-show",value:void 0===t.hidden||!t.hidden,expression:"item.hidden === undefined || !item.hidden"}],tag:"component",staticClass:"preview-element",class:{current:e.currentModule.uuid===t.uuid},attrs:{uuid:t.uuid,"project-type":e.projectType,code:e.code},nativeOn:{click:function(n){return n.stopPropagation(),e.changeCurrentModule(n,t)}}}):e._e()],n("div",{staticClass:"component-item-operate-box",class:{right:"left"!==e.previewBtnGroupAlign,left:"left"===e.previewBtnGroupAlign}},["layoutc"!==t.mark?n("a",{staticClass:"btn-icon",attrs:{title:"复制",href:"javascript:;"},on:{click:function(n){return n.stopPropagation(),e.copyModule(t,i)}}},[n("a-icon",{attrs:{type:"copy"}})],1):e._e(),n("a",{staticClass:"btn-icon",attrs:{title:"删除",href:"javascript:;"},on:{click:function(t){return t.stopPropagation(),e.removeModule(i)}}},[n("a-icon",{attrs:{type:"delete"}})],1)])],2)})),0)},a=[],r=(n("8e6e"),n("456d"),n("ac6a"),n("7514"),n("96cf"),n("3b8d")),o=n("bd86"),s=n("2f62"),c=n("381a"),l=n.n(c),u=n("2ef0"),d=n.n(u),p=n("310e"),f=n.n(p),m=n("6892");function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){Object(o["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=Object(s["a"])("panelDesigner"),b=v.mapMutations,y=v.mapActions,C={name:"WorkPanel",data:function(){return{targetList:[],componentMap:{}}},methods:h(h(h({},b(["setModuleConfig","removeConfig","updateConfigMap","updateCurrentModule"])),y({modifyCurrentModule:"modifyCurrentModule",setModuleConfig:"setModuleConfig"})),{},{addModule:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.disabled){e.next=2;break}return e.abrupt("return",!1);case 2:if(n=t.item._underlying_vm_,i={mark:n.mark},a=t.newIndex,this.beforeModuleJoinValidate(i)){e.next=7;break}return e.abrupt("return",!1);case 7:return e.next=9,this.addModuleObj(i,a);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),addPreviewModuleObj:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n,i){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:void 0!==n&&this.updateConfigMap({key:this.code,configMap:n}),this.loadModule(t),this.targetList.splice(i,1,t);case 3:case"end":return e.stop()}}),e,this)})));function t(t,n,i){return e.apply(this,arguments)}return t}(),addModuleObj:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n,i){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return void 0===t.uuid&&(t.uuid=l()(16,{numbers:!1})),this.loadModule(t),e.next=4,this.modifyCurrentModule({key:this.code,module:t});case 4:a=void 0!==i&&i?0:1,this.targetList.splice(n,a,t),this.targetList=this.targetList.filter((function(e){return void 0!==e.uuid})),this.$emit("add",t),this.$emit("input",this.targetList),this.$forceUpdate();case 10:case"end":return e.stop()}}),e,this)})));function t(t,n,i){return e.apply(this,arguments)}return t}(),autoAppendModule:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.targetList.find((function(e){return e.mark===t})),void 0===n){e.next=3;break}return e.abrupt("return",!1);case 3:return i={mark:t,hidden:!0},e.next=6,this.addModuleObj(i,0,!0);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),copyModule:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){var i,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return i=d.a.cloneDeep(t),i.uuid=l()(16,{numbers:!1}),a=d.a.cloneDeep(this.moduleConfigMap[t.uuid]),a.uuid=i.uuid,this.setModuleConfig({key:this.code,uuid:i.uuid,config:a}),this.targetList.splice(n+1,0,i),r=d.a.cloneDeep(this.targetList),e.next=9,this.modifyCurrentModule({key:this.code,module:i});case 9:this.$emit("add",i),this.$emit("input",r),this.$forceUpdate();case 12:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}(),removeModule:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=d.a.cloneDeep(this.targetList[t]),i=void 0!==this.targetList[t-1]?this.targetList[t-1]:this.targetList[t+1],void 0===i){e.next=5;break}return e.next=5,this.modifyCurrentModule({key:this.code,module:i});case 5:this.targetList.splice(t,1),a=d.a.cloneDeep(this.targetList),this.$emit("remove",{m:n,targetList:a}),this.$emit("input",a);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),autoRemoveModule:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=this.targetList.find((function(e){return e.mark===t})),void 0!==n){e.next=3;break}return e.abrupt("return",!1);case 3:if(i=this.targetList.indexOf(n),-1!==i){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,this.removeModule(i);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),loadModule:function(e){var t=this.componentMap[e.mark];t||(this.componentMap[e.mark]=function(){return n("8c5a")("./".concat(e.mark,"/index.vue"))})},changeCurrentModule:function(e,t){if(this.disabled)return!1;"layoutc"!==t.mark&&e.preventDefault(),this.modifyCurrentModule({key:this.code,module:t}),m["a"].$emit("switchModuleConfigPanel_".concat(this.code))},autoSetModuleConfig:function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n,i){var a,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=this.targetList.find((function(e){return e.mark===t})),void 0!==a){e.next=4;break}return e.next=4,this.autoAppendModule(t);case 4:if(a=this.targetList.find((function(e){return e.mark===t})),void 0!==a){e.next=7;break}return e.abrupt("return",!1);case 7:r=a.uuid,o=this.$store.state.panelDesigner[this.code].moduleConfigMap,n.uuid=r,n.mark=t,o[r]=n,this.updateConfigMap({key:this.code,configMap:o}),i&&i(a);case 14:case"end":return e.stop()}}),e,this)})));function t(t,n,i){return e.apply(this,arguments)}return t}(),clearAllModuleList:function(){this.targetList=[]},clearModuleListConfig:function(e){var t=this;!e||e.length<0||e.forEach((function(e){t.removeModuleConfig(e)}))},removeModuleConfig:function(e){this.removeConfig({key:this.code,uuid:e.uuid})}}),watch:{targetList:function(e){"preview"!==this.code&&this.$emit("input",e)}},computed:h(h({},Object(s["f"])({previewBtnGroupAlign:function(e){return e.customProperties.designer.previewBtnGroupAlign}})),{},{currentModule:function(){return this.$store.state.panelDesigner[this.code].currentModule},moduleConfigMap:function(){return this.$store.state.panelDesigner[this.code].moduleConfigMap},disabled:function(){return"preview"===this.code}}),mounted:function(){this.targetList=d.a.cloneDeep(this.value)},props:{value:{type:Array,default:function(){return[]}},type:{type:String,default:""},code:{type:String,default:""},projectType:{type:String,required:!0},beforeModuleJoinValidate:{type:Function,default:function(){return!0}}},components:{draggable:f.a},created:function(){var e=this;"root"===this.type&&(m["a"].$on("autoAppendModule_".concat(this.code),function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.autoAppendModule(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),m["a"].$on("autoRemoveModule_".concat(this.code),function(){var t=Object(r["a"])(regeneratorRuntime.mark((function t(n){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.autoRemoveModule(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),m["a"].$on("autoSetModuleConfig_".concat(this.code),(function(t){var n=t.mark,i=t.moduleConfig,a=t.callback;e.autoSetModuleConfig(n,i,a)})),m["a"].$on("autoChangeCurrentModule_".concat(this.code),(function(t){e.updateCurrentModule({key:e.code,module:t})})))},destroyed:function(){this.clearModuleListConfig(this.targetList),"root"===this.type&&(m["a"].$off("autoAppendModule_".concat(this.code)),m["a"].$off("autoRemoveModule_".concat(this.code)),m["a"].$off("autoSetModuleConfig_".concat(this.code)),m["a"].$off("autoChangeCurrentModule_".concat(this.code)))}},k=C,w=(n("92ee"),n("2877")),M=Object(w["a"])(k,i,a,!1,null,"23de1fb1",null);t["a"]=M.exports},"2a35":function(e,t,n){},"38a8":function(e,t,n){},5444:function(e,t,n){"use strict";n("67517")},67517:function(e,t,n){},"6ef5":function(e,t,n){var i={"./generalForm/config.vue":["85e1","designerModuleConfig0~designerModuleConfig11~designerModuleConfig3~designerModuleConfig5~designerMod~f49b3302","designerModuleConfig0"],"./generalList/config.vue":["44a5","designerModuleConfig1"],"./layoutc/config.vue":["7219","designerModuleConfig2"],"./operateLine/config.vue":["ab09","designerModuleConfig0~designerModuleConfig11~designerModuleConfig3~designerModuleConfig5~designerMod~f49b3302","chunk-344e89be","designerModuleConfig11~designerModuleConfig3~designerModuleConfig5","designerModuleConfig3"],"./paddingc/config.vue":["99ec","designerModuleConfig4"],"./panelContainer/config.vue":["0ef2","designerModuleConfig0~designerModuleConfig11~designerModuleConfig3~designerModuleConfig5~designerMod~f49b3302","chunk-344e89be","designerModuleConfig11~designerModuleConfig3~designerModuleConfig5","designerModuleConfig5"],"./panelData/config.vue":["3319","designerModuleConfig6"],"./panelProps/config.vue":["af7f","designerModuleConfig0~designerModuleConfig11~designerModuleConfig3~designerModuleConfig5~designerMod~f49b3302","designerModuleConfig7"],"./tableSearch/config.vue":["03e1","designerModuleConfig8"],"./tabsPage/config.vue":["d966","designerModuleConfig9"],"./timeline/config.vue":["5381","designerModuleConfig10"],"./titleLine/config.vue":["d007","designerModuleConfig0~designerModuleConfig11~designerModuleConfig3~designerModuleConfig5~designerMod~f49b3302","chunk-344e89be","designerModuleConfig11~designerModuleConfig3~designerModuleConfig5","designerModuleConfig11~designerModuleConfig14","designerModuleConfig11"],"./treeList/config.vue":["42d3","designerModuleConfig12"],"./treeStruct/config.vue":["11f3","designerModuleConfig13"]};function a(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id="6ef5",e.exports=a},"868f":function(e,t,n){"use strict";n("2a35")},"8c5a":function(e,t,n){var i={"./generalForm/index.vue":["18a5","chunk-4bd6d997","designerModule0~designerModule3","designerModule0"],"./generalList/index.vue":["b13d","designerModule1"],"./layoutc/index.vue":["c3d1","designerModule2~designerModule4","designerModule2"],"./operateLine/index.vue":["77b1","chunk-4bd6d997","designerModule0~designerModule3","designerModule3"],"./paddingc/index.vue":["8c96","designerModule2~designerModule4","designerModule4"],"./panelContainer/index.vue":["2728","designerModule5~designerModule7","designerModule5"],"./panelData/index.vue":["df2c","designerModule6"],"./panelProps/index.vue":["05f4","designerModule5~designerModule7","designerModule7"],"./tableSearch/index.vue":["93fc","designerModule8"],"./tabsPage/index.vue":["920a","designerModule9"],"./timeline/index.vue":["539d","designerModule10"],"./titleLine/index.vue":["3a46","designerModule11"],"./treeList/index.vue":["c047","designerModule12"],"./treeStruct/index.vue":["f003","designerModule13"]};function a(e){if(!n.o(i,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=i[e],a=t[0];return Promise.all(t.slice(1).map(n.e)).then((function(){return n(a)}))}a.keys=function(){return Object.keys(i)},a.id="8c5a",e.exports=a},"8f38":function(e,t,n){"use strict";n("38a8")},"92ee":function(e,t,n){"use strict";n("01e0")},9391:function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-main"},[n("div",{staticClass:"designer-container"},[n("a-form-model",{ref:"panelInfoForm",staticClass:"main-form",staticStyle:{background:"#e8f1ff"},attrs:{layout:"inline",model:e.panelInfo,rules:e.panelInfoRules}},[n("a-form-model-item",{staticStyle:{"margin-left":"5px","margin-right":"0"}},[n("a-popconfirm",{attrs:{title:"您确认新建一个面板吗？","ok-text":"确认","cancel-text":"取消",placement:"bottomLeft"},on:{confirm:e.reset}},[n("a-button",{attrs:{type:"link",icon:"plus"}})],1)],1),n("a-form-model-item",{staticStyle:{"margin-right":"0"}},[n("a-popover",{attrs:{placement:"bottomLeft",title:"选择面板进行编辑",trigger:"click"}},[n("a-button",{attrs:{type:"link",icon:"edit"}}),n("div",{attrs:{slot:"content"},slot:"content"},[e.panelList&&e.panelList.length>0?[n("a-select",{staticStyle:{width:"360px"},attrs:{"show-search":"","filter-option":e.filterOption,placeholder:"选择一个面板"},on:{change:e.onPanelChanged},model:{value:e.panelInfo.id,callback:function(t){e.$set(e.panelInfo,"id",t)},expression:"panelInfo.id"}},e._l(e.panelList,(function(t){return n("a-select-option",{key:t.id,attrs:{value:t.id}},[e._v("\n                  "+e._s(t.panelName)+" ["+e._s(t.panelCode)+"]\n                ")])})),1)]:[e._v("\n              还没有面板可供编辑，请先新建\n            ")]],2)],1)],1),n("a-form-model-item",[n("a-popover",{attrs:{placement:"leftTop",title:"常用设置",trigger:"click"}},[n("div",{staticStyle:{width:"280px",height:"120px"},attrs:{slot:"content"},slot:"content"},[n("a-form-model",e._b({attrs:{layout:"horizontal"}},"a-form-model",{labelCol:{span:12},wrapperCol:{span:12}},!1),[n("a-form-model-item",{attrs:{label:"预览区按钮对齐方式"}},[n("a-radio-group",{attrs:{value:e.previewBtnGroupAlign},on:{change:function(t){return e.$store.commit("SET_DESINGER_PREVIEW_BTN_GROUP_ALIGN",t.target.value)}}},[n("a-radio-button",{attrs:{value:"left"}},[n("a-icon",{attrs:{type:"align-left"}})],1),n("a-radio-button",{attrs:{value:"right"}},[n("a-icon",{attrs:{type:"align-right"}})],1)],1)],1)],1)],1),n("a-button",{attrs:{type:"link",icon:"setting",title:"设置"}})],1)],1),n("a-form-model-item",[void 0===e.panelInfo.id?[e._v("\n          状态：\n          "),n("a-tag",{attrs:{color:"#87d068"}},[e._v("\n            新建\n          ")])]:[e._v("\n          状态：\n          "),n("a-tag",{attrs:{color:"#2db7f5"}},[e._v("\n            更新\n          ")])]],2),n("a-form-model-item",{attrs:{label:"面板名称",prop:"name"}},[n("a-input",{model:{value:e.panelInfo.name,callback:function(t){e.$set(e.panelInfo,"name",t)},expression:"panelInfo.name"}})],1),n("a-form-model-item"),n("a-form-model-item",{attrs:{label:"编码/文件名",prop:"code"}},[n("a-input",{on:{change:function(t){e.panelInfo.fileName=e.panelInfo.code}},model:{value:e.panelInfo.code,callback:function(t){e.$set(e.panelInfo,"code",t)},expression:"panelInfo.code"}})],1),n("a-form-model-item",{attrs:{label:"所在目录",prop:"dirPath"}},[n("a-popover",{attrs:{trigger:"click"}},[n("span",{attrs:{slot:"title"},slot:"title"},[e._v("\n            所在目录选择\n            "),n("a-button",{staticStyle:{float:"right","margin-top":"-4px"},attrs:{type:"link",icon:"reload"},on:{click:function(t){return e.$refs.dirSelector.initDirList()}}})],1),n("a",{attrs:{slot:"content"},slot:"content"},[n("dir-selector",{ref:"dirSelector",model:{value:e.panelInfo.dirPath,callback:function(t){e.$set(e.panelInfo,"dirPath",t)},expression:"panelInfo.dirPath"}})],1),n("a-button",{attrs:{type:"link"}},[e._v("\n            "+e._s(e.panelInfo.dirPath)+"\n          ")])],1)],1),n("a-form-model-item",[n("a-button",{directives:[{name:"permission",rawName:"v-permission",value:["f_pc_panel_generate"],expression:"['f_pc_panel_generate']"}],attrs:{type:"primary",loading:e.state.loading,icon:"plus"},on:{click:e.beforeGenerate}},[e._v("\n          添加&生成当前面板\n        ")])],1)],1),n("div",{staticStyle:{height:"10px"}}),n("designer",{ref:"pc_designer_"+e.pane.code,attrs:{code:e.pane.code,"project-type":e.projectType,"init-module-mark-list":e.pane.moduleList},on:{add:e.addModule,remove:e.removeModule,change:function(t){return e.moduleListChanged(e.pane.code,t)}}})],1)])},a=[],r=(n("8e6e"),n("456d"),n("bd86")),o=(n("6762"),n("2fdb"),n("28a5"),n("7514"),n("ac6a"),n("7f7f"),n("96cf"),n("3b8d")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"drag-modules"},[n("div",{staticClass:"modules-box"},[e._l(e.sourceList,(function(t,i){return[n("div",{directives:[{name:"show",rawName:"v-show",value:void 0===t.hidden||!t.hidden,expression:"s.hidden === undefined || !s.hidden"},{name:"permission",rawName:"v-permission",value:t.list.map((function(e){return"pc_panel_m_"+e.mark})),expression:"s.list.map(col => {return `pc_panel_m_${col.mark}`})"}],key:t+"_"+i},[n("h3",{staticClass:"title-line"},[e._v(e._s(t.name))]),n("draggable",{attrs:{element:"a-row","ghost-class":"sortable-ghost",options:{group:{name:"compgroup",pull:"clone",put:!1},sort:!1}},model:{value:t.list,callback:function(n){e.$set(t,"list",n)},expression:"s.list"}},[e._l(t.list,(function(t){return[n("div",{directives:[{name:"permission",rawName:"v-permission",value:["pc_panel_m_"+t.mark],expression:"[`pc_panel_m_${item.mark}`]"}],key:t.mark,staticClass:"module-item",class:{current:e.currentModule.mark===t.mark}},[n("p",{staticClass:"item-line"},[n("span",{staticClass:"item-icon"},[n("a-icon",{attrs:{type:t.icon}})],1),e._v("\n                  "+e._s(t.name)+"\n                ")])])]}))],2)],1)]}))],2),n("div",{staticClass:"preview-container",style:"height: "+e.workPanelHeight+"px;max-width: "+e.workPanelMaxWidth+"px"},[n("div",{staticClass:"module-modal"},[n("work-panel",{ref:"workPanel",attrs:{type:"root",code:e.code,"project-type":e.projectType},on:{add:function(t){return e.$emit("add",t)},remove:function(t){return e.$emit("remove",t)}},model:{value:e.targetList,callback:function(t){e.targetList=t},expression:"targetList"}})],1)]),n("div",{staticClass:"config-page"},[n("config-page",{ref:"configPage",attrs:{"project-type":e.projectType,code:e.code}})],1)]),n("a-modal",{attrs:{title:"当前配置文本",width:"800px"},model:{value:e.model1,callback:function(t){e.model1=t},expression:"model1"}},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.configMapStr,expression:"configMapStr"}],attrs:{name:"moduleConfigMap",id:"moduleConfigMap",cols:"30",rows:"30"},domProps:{value:e.configMapStr},on:{input:function(t){t.target.composing||(e.configMapStr=t.target.value)}}})])],1)},c=[],l=n("310e"),u=n.n(l),d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"tabs-container",class:{expand:e.expand},style:"height: "+(e.configPanelHeight+100)+"px;"+(e.expand?"width: "+e.designerConfigPanelWidth+"px;":"")},[n("a-tabs",{staticClass:"all-config-tabs",model:{value:e.panelActiveKey,callback:function(t){e.panelActiveKey=t},expression:"panelActiveKey"}},[n("template",{slot:"tabBarExtraContent"},[!0===e.expand&&!0===e.expandComplete?n("a-popover",{attrs:{placement:"leftTop",title:"常用设置",trigger:"click"}},[n("div",{staticStyle:{width:"200px",height:"120px"},attrs:{slot:"content"},slot:"content"},[n("a-form-model",e._b({attrs:{layout:"horizontal"}},"a-form-model",{labelCol:{span:6},wrapperCol:{span:18}},!1),[n("a-form-model-item",{attrs:{label:"宽度"}},[n("a-radio-group",{attrs:{value:e.panelWidthType},on:{change:function(t){return e.$store.commit("SET_DESINGER_CONFIG_PANEL_WIDTH_TYPE",t.target.value)}}},[n("a-radio-button",{attrs:{value:"large"}},[e._v("\n                  宽\n                ")]),n("a-radio-button",{attrs:{value:"normal"}},[e._v("\n                  中\n                ")]),n("a-radio-button",{attrs:{value:"small"}},[e._v("\n                  窄\n                ")])],1)],1)],1)],1),n("a-button",{attrs:{icon:"setting",type:"link"}})],1):e._e(),n("a-button",{attrs:{type:"link",icon:e.expand?"double-right":"double-left"},on:{click:e.toggleExpand}})],1),n("a-tab-pane",{key:"config_1",attrs:{tab:"组件属性"}},[n("div",{staticClass:"config-container",style:"height: "+e.configPanelHeight+"px;"},e._l(e.moduleConfigMap,(function(t){return n(e.componentMap[t.mark],{directives:[{name:"show",rawName:"v-show",value:!!e.currentModule.uuid&&e.currentModule.uuid===t.uuid,expression:"!!currentModule.uuid && currentModule.uuid === item.uuid"}],key:t.uuid,ref:e.code+"_config_"+t.uuid,refInFor:!0,tag:"component",attrs:{uuid:t.uuid,code:e.code,"project-type":e.projectType}})})),1)]),n("a-tab-pane",{key:"config_2",attrs:{tab:"通用属性","force-render":!0}},[n("common-config",{ref:"commonConfigTab",staticClass:"config-container",style:"height: "+e.configPanelHeight+"px;",attrs:{"project-type":e.projectType,code:e.code}})],1)],2)],1)},p=[],f=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-box"},[n("general-props-config",{directives:[{name:"permission",rawName:"v-permission",value:["pc_panel_m_panelProps"],expression:"['pc_panel_m_panelProps']"}],ref:"generalPropsConfig",attrs:{code:e.code}}),n("general-data-config",{directives:[{name:"permission",rawName:"v-permission",value:["pc_panel_m_panelData"],expression:"['pc_panel_m_panelData']"}],ref:"generalDataConfig",attrs:{code:e.code}}),n("a-form",{directives:[{name:"permission",rawName:"v-permission",value:["f_pc_panel_event_kit"],expression:"['f_pc_panel_event_kit']"}],attrs:{layout:"horizontal"}},[n("h3",{staticClass:"title separator"},[e._v("面板事件设置")]),e.emitEventList.length>0?n("a-collapse",{attrs:{"default-active-key":"config_panel_0",bordered:!1}},[e._l(e.emitEventList,(function(t,i){return[n("a-collapse-panel",{key:"config_panel_"+i,attrs:{header:t.key?t.key:"事件设置"}},[n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"事件"}},[n("a-tag",{attrs:{color:"blue"}},[e._v("\n              "+e._s(t.key)+"\n            ")])],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"参数"}},[t.params.length>0?e._l(t.params,(function(t){return n("a-tag",{key:t.key,attrs:{color:"cyan"}},[e._v("\n                "+e._s(t.key)+"\n              ")])})):[e._v("\n              无\n            ")]],2),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"来源"}},[n("a-tag",{attrs:{color:"#2db7f5"}},[e._v("\n              "+e._s(t.origin)+"\n            ")])],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"备注"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"事件备注"},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"emitEvent.name"}})],1)],1)]}))],2):[e._v("\n      暂无事件列表\n    ")]],2)],1)},m=[],g=n("75fc"),h=(n("a481"),n("4917"),n("2ef0")),v=n.n(h),b=n("2f62"),y=n("6892");function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var w=Object(b["a"])("panelDesigner"),M=w.mapState,_={data:function(){return{emitEventList:[]}},methods:{extractEmitEventList:function(e,t){if(e&&e.includes("this.$emit(")){var n=/this.\$emit\((.+?)\)/g,i=e.match(n);if(i&&0!==i.length){for(var a=0,r=[],o=0;o<i.length;o++){var s=i[o];s=s.replace(/this.\$emit\(/g,"").replace(/\)/g,"");for(var c=s.split(","),l="",u=0,d=[],p=0;p<c.length;p++){var f=c[p];f=f.trim(),f&&(f.includes('"')||f.includes("'")?l=f.replace(/"/g,"").replace(/'/g,""):(f.includes(".")&&(f=f.slice(f.lastIndexOf(".")+1,f.length)),d.push({key:f,name:"参数".concat(++u),type:"String"})))}l&&r.push({key:l,name:"事件说明".concat(++a),params:d,origin:t})}return r}}},collectEmitEvents4configMap:function(e){var t=this,n=[];if(v.a.forEach(e,(function(e,i){if("panelProps"===e.mark){if(e.metadata.propConfigList&&e.metadata.propConfigList.length>0)for(var a=0;a<e.metadata.propConfigList.length;a++){var r,o=e.metadata.propConfigList[a],s=t.extractEmitEventList(o.watchCode,"自定义入参watch函数");void 0!==s&&(r=n).push.apply(r,Object(g["a"])(s))}}else if("operateLine"===e.mark){if(e.metadata.btnConfigList&&e.metadata.btnConfigList.length>0)for(var c=0;c<e.metadata.btnConfigList.length;c++){var l,u=e.metadata.btnConfigList[c],d=[];"click"===u.event?d=t.extractEmitEventList(u.clickEvent.handlerCode,"操作栏按钮点击事件"):"popWindow"===u.event&&u.confirmEvent.open&&(d=t.extractEmitEventList(u.confirmEvent.handlerCode,"操作栏弹窗确认事件")),void 0!==d&&0!==d.length&&(l=n).push.apply(l,Object(g["a"])(d))}}else if(e.scriptConfig){if(e.scriptConfig.event&&e.scriptConfig.event.length>0)for(var p=0;p<e.scriptConfig.event.length;p++){var f,m=e.scriptConfig.event[p],h=t.extractEmitEventList(m.handlerCode,"自定义事件处理函数");void 0!==h&&(f=n).push.apply(f,Object(g["a"])(h))}if(e.scriptConfig.emitEvent&&e.scriptConfig.emitEvent.length>0)for(var b=0;b<e.scriptConfig.emitEvent.length;b++){var y=v.a.cloneDeep(e.scriptConfig.emitEvent[b]);y.origin="组件内置/生成代码",n.push(y)}}})),0===n.length)return[];var i={};return n=n.reduce((function(e,t){return!i[t.key]&&(i[t.key]=e.push(t)),e}),[]),n},smartMergeEventList:function(e){var t;if(void 0===e&&(e=[]),0!==this.emitEventList.length){var n=e.map((function(e){return e.key}));this.emitEventList=this.emitEventList.filter((function(e){return n.includes(e.key)}));var i={};e.forEach((function(e){i[e.key]=e}));for(var a=0;a<this.emitEventList.length;a++){var r=this.emitEventList[a],o=i[r.key];if(o){var s=r.params.map((function(e){return e.key})).join("_"),c=o.params.map((function(e){return e.key})).join("_");s!==c&&(r.params=o.params)}}var l=this.emitEventList.map((function(e){return e.key})),u=e.filter((function(e){return!l.includes(e.key)}));(t=this.emitEventList).push.apply(t,Object(g["a"])(u))}else{var d;(d=this.emitEventList).push.apply(d,Object(g["a"])(e))}}},computed:k({},M({moduleConfigMap:function(e){return e.default.moduleConfigMap}})),watch:{moduleConfigMap:{handler:function(e){var t=this.collectEmitEvents4configMap(e);this.smartMergeEventList(t)},deep:!0}},created:function(){var e=this;y["a"].$on("collectPanelEvents",(function(t){y["a"].$emit("collectPanelEventsComplete",{type:t,emitEventList:e.emitEventList})}))}},x=n("8141"),O=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("a-form",{staticClass:"panel-props-config ",attrs:{layout:"horizontal"}},[n("h3",{staticClass:"title separator"},[e._v("\n      面板入参props\n      "),n("a-icon",{staticStyle:{cursor:"pointer",color:"rgb(24, 144, 255)"},attrs:{type:"plus-circle"},on:{click:e.addProp}})],1),n("a-collapse",{attrs:{"default-active-key":"0",bordered:!1},model:{value:e.panelActiveKey,callback:function(t){e.panelActiveKey=t},expression:"panelActiveKey"}},[e._l(e.moduleConfig.metadata.propConfigList,(function(t,i){return[n("a-collapse-panel",{key:"config_panel_"+i,attrs:{header:t.key?t.key:"参数"+(i+1)+" 配置"}},[n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"参数"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"参数名称"},model:{value:t.key,callback:function(n){e.$set(t,"key",n)},expression:"config.key"}})],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"说明"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"参数说明"},model:{value:t.name,callback:function(n){e.$set(t,"name",n)},expression:"config.name"}})],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"类型"}},[n("a-select",{staticStyle:{width:"100%"},attrs:{placeholder:"参数类型",size:"small"},model:{value:t.type,callback:function(n){e.$set(t,"type",n)},expression:"config.type"}},[n("a-select-option",{attrs:{value:"String"}},[e._v("\n                String\n              ")]),n("a-select-option",{attrs:{value:"Array"}},[e._v("\n                Array\n              ")]),n("a-select-option",{attrs:{value:"Object"}},[e._v("\n                Object\n              ")]),n("a-select-option",{attrs:{value:"Function"}},[e._v("\n                Function\n              ")]),n("a-select-option",{attrs:{value:"Number"}},[e._v("\n                Number\n              ")]),n("a-select-option",{attrs:{value:"Boolean"}},[e._v("\n                Boolean\n              ")])],1)],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"默认值"}},[n("a-input",{staticStyle:{width:"100%"},attrs:{size:"small",placeholder:"参数默认值"},model:{value:t.default,callback:function(n){e.$set(t,"default",n)},expression:"config.default"}})],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"必填项"}},[n("a-switch",{attrs:{"checked-children":"是","un-checked-children":"否"},model:{value:t.required,callback:function(n){e.$set(t,"required",n)},expression:"config.required"}})],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:10},wrapperCol:{span:14},label:"参数变化检测"}},[n("a-switch",{attrs:{"checked-children":"启用","un-checked-children":"不启用"},model:{value:t.hasWatch,callback:function(n){e.$set(t,"hasWatch",n)},expression:"config.hasWatch"}})],1),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:10},wrapperCol:{span:14},label:"初始化时检测"}},[n("a-switch",{attrs:{"checked-children":"启用","un-checked-children":"不启用"},model:{value:t.immediate,callback:function(n){e.$set(t,"immediate",n)},expression:"config.immediate"}})],1),t.hasWatch?n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:10},wrapperCol:{span:14},label:"参数检测代码"}},[n("a-popover",{attrs:{title:"参数检测代码编辑",placement:"left",trigger:"click"}},[n("template",{slot:"content"},[n("smart-code-editor",{attrs:{code:e.code},model:{value:t.watchCode,callback:function(n){e.$set(t,"watchCode",n)},expression:"config.watchCode"}})],1),n("a-button",{attrs:{type:"link"}},[e._v("\n                设置\n              ")])],2)],1):e._e(),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:18},label:"操作"}},[n("a-button",{staticStyle:{"margin-right":"8px"},attrs:{size:"small",type:"primary",icon:"copy"},on:{click:function(t){return e.copyProp(i)}}},[e._v("\n              复制\n            ")]),n("a-popconfirm",{attrs:{placement:"topLeft",title:"是否确认删除该按钮？","ok-text":"是","cancel-text":"否"},on:{confirm:function(t){return e.removeProp(i)}}},[n("a-button",{attrs:{size:"small",type:"danger",icon:"delete"}},[e._v("\n                删除\n              ")])],1)],1)],1)]}))],2)],1)],1)},L=[],P=n("788b"),j=n("80da"),D={key:"props",name:"入参参数",type:"String",default:"",required:!1,hasWatch:!0,immediate:!1,watchCode:"function(val) {\n  // 数据更改处理流程\n}"},$="panelProps",E={name:"GeneralPropsConfig",data:function(){return{panelActiveKey:"config_panel_0",moduleConfig:{metadata:{propConfigList:[]}}}},methods:{validateComplete:function(e){this.moduleConfig.metadata.propConfigList.length>0&&y["a"].$emit("validateComplete",{mark:this.moduleConfig.mark,err:e})},addProp:function(){this.moduleConfig.metadata.propConfigList.push(v.a.cloneDeep(D)),this.panelActiveKey="config_panel_".concat(this.moduleConfig.metadata.propConfigList.length-1)},autoAddProp:function(e){if(!e)return!1;var t=this.moduleConfig.metadata.propConfigList.find((function(t){return t.key===e.key}));if(void 0!==t)return!1;this.moduleConfig.metadata.propConfigList.push(v.a.clone(e))},autoRemoveProp:function(e){if(!e||0===e.length)return!1;this.moduleConfig.metadata.propConfigList=this.moduleConfig.metadata.propConfigList.filter((function(t){return void 0!==t&&!e.includes(t.key)}))},copyProp:function(e){var t=v.a.cloneDeep(this.moduleConfig.metadata.propConfigList[e]);this.moduleConfig.metadata.propConfigList.splice(e,0,t),this.panelActiveKey="config_panel_".concat(e+1)},removeProp:function(e){this.moduleConfig.metadata.propConfigList.splice(e,1),e>0?this.panelActiveKey="config_panel_".concat(e-1):this.moduleConfig.metadata.propConfigList.length>0&&(this.panelActiveKey="config_panel_".concat(0))},onModuleConfigChanged:function(e){var t=this;if(0===e.metadata.propConfigList.length)y["a"].$emit("autoRemoveModule_".concat(this.code),$);else{var n=this.$store.state[this.workspace][this.code].currentModule;y["a"].$emit("autoSetModuleConfig_".concat(this.code),{mark:$,moduleConfig:e,callback:function(e){e&&n&&e.uuid!==n.uuid&&y["a"].$emit("autoChangeCurrentModule_".concat(t.code),n)}})}},resetData:function(){console.log("general props config reset data")}},components:{smartCodeEditor:P["a"]},mixins:[j["a"]],props:{workspace:{type:String,default:"panelDesigner"},code:{type:String,default:""}},created:function(){var e=this;this.unwatch=this.$watch("moduleConfig",{handler:this.onModuleConfigChanged,deep:!0}),y["a"].$on("setGeneralPropsConfig_".concat(this.code),(function(t){e.unwatch&&e.unwatch(),void 0!==t?e.moduleConfig=t:e.moduleConfig.metadata.propConfigList=[],e.unwatch=e.$watch("moduleConfig",{handler:e.onModuleConfigChanged,deep:!0})})),y["a"].$on("addGlobalProp",(function(t){e.autoAddProp(t)})),y["a"].$on("removeGlobalProp",(function(t){e.autoRemoveProp(t)}))},destroyed:function(){y["a"].$off("setGeneralPropsConfig"),y["a"].$off("addGlobalProp"),y["a"].$off("removeGlobalProp")}},S=E,I=(n("d39e"),n("2877")),R=Object(I["a"])(S,O,L,!1,null,"63511a4c",null),N=R.exports,T={name:"CommonConfig",mixins:[_],methods:{resetData:function(){this.$refs.generalPropsConfig.resetData(),this.$refs.generalDataConfig.resetData()}},components:{generalDataConfig:x["a"],generalPropsConfig:N},props:{code:{type:String,default:""}}},A=T,z=(n("f014"),Object(I["a"])(A,f,m,!1,null,"541ff1e0",null)),G=z.exports,W=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"event-layout"},[n("a-form",{attrs:{layout:"horizontal"}},[n("h3",{staticClass:"title separator"},[e._v("入参配置")]),n("a-row",[n("a-col",{attrs:{spna:22}})],1)],1)],1)},q=[],K={name:"EventLayout",data:function(){return{}}},F=K,V=(n("5444"),Object(I["a"])(F,W,q,!1,null,"2e1342a2",null)),H=V.exports;function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?B(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var U={name:"ConfigPage",data:function(){return{panelActiveKey:"config_1",showConfigPannel:!0,componentMap:{},configPanelHeight:60,expand:!1,expandComplete:!1,expandTimer:0}},methods:{removeCurrentModule:function(){this.$emit("removeCurrentModule")},loadModule:function(e){var t=this.componentMap[e.mark];t||(this.componentMap[e.mark]=function(){return n("6ef5")("./".concat(e.mark,"/config.vue"))})},resetData:function(){this.$refs.commonConfigTab.resetData()},windowResize:function(){var e=180;this.configPanelHeight=window.innerHeight-e},toggleExpand:function(){var e=this;this.expand=!this.expand,!0===this.expand?this.expandTimer=setTimeout((function(){e.expandComplete=!0}),200):(clearInterval(this.expandTimer),this.expandComplete=!1)}},watch:{currentModule:function(e){e.mark&&e.uuid&&this.loadModule(e)}},computed:J(J(J({},Object(b["f"])({panelWidthType:function(e){return e.customProperties.designer.configPanelWidthType}})),Object(b["d"])(["designerConfigPanelWidth"])),{},{currentModule:function(){return this.$store.state.panelDesigner[this.code].currentModule},moduleConfigMap:function(){return this.$store.state.panelDesigner[this.code].moduleConfigMap}}),components:{commonConfig:G,eventLayout:H},props:{code:{type:String,required:!0},projectType:{type:String,required:!0}},created:function(){var e=this;this.windowResize(!1),window.addEventListener("resize",this.windowResize),y["a"].$on("switchModuleConfigPanel_".concat(this.code),(function(){e.panelActiveKey="config_1"}))},destroyed:function(){window.removeEventListener("resize",this.windowResize)}},Y=U,Z=(n("8f38"),Object(I["a"])(Y,d,p,!1,null,"8446dd16",null)),Q=Z.exports,X=n("1248"),ee=[{name:"业务组件",list:[{name:"树列表",icon:"align-left",mark:"treeList",unique:!0},{name:"树结构",icon:"apartment",mark:"treeStruct",unique:!0},{name:"通用列表",icon:"align-center",mark:"generalList",unique:!0},{name:"通用表单",icon:"form",mark:"generalForm",unique:!0},{name:"标签页",icon:"border-top",mark:"tabsPage"},{name:"时间轴",icon:"clock-circle",mark:"timeline",unique:!0}]},{name:"面板集成",hidden:!0,list:[{name:"入参配置",icon:"login",mark:"panelProps"},{name:"通用参数",icon:"code-sandbox",mark:"panelData"}]},{name:"基础组件",list:[{name:"间隔行",icon:"column-height",mark:"paddingc"},{name:"标题行",icon:"line-height",mark:"titleLine"},{name:"操作栏",icon:"control",mark:"operateLine"},{name:"布局器",icon:"layout",mark:"layoutc"},{name:"面板容器",icon:"block",mark:"panelContainer"}]}],te=function(e){if(!e||0===e.length)return[];var t=[];return e.forEach((function(e){if(!e.list||0===e.list.length)return!0;var n=e.list.map((function(t){var n=v.a.cloneDeep(t);return n.allName="".concat(e.name,"-").concat(t.name),n}));t.push.apply(t,Object(g["a"])(n))})),t},ne=function(e){if(!e||0===e.length)return{};var t={};return e.forEach((function(e){if(!e.list||0===e.list.length)return!0;e.list.forEach((function(n){t[n.mark]={allName:"".concat(e.name,"-").concat(n.name),icon:n.icon,name:n.name,mark:n.mark}}))})),t};function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var re=Object(b["a"])("panelDesigner"),oe=re.mapMutations,se={name:"PanelDesigner",data:function(){return{model1:!1,sourceList:ee,targetList:[],workPanelHeight:300,workPanelMaxWidth:1920}},methods:ae(ae({},oe(["resetDesigner","updateConfigMap"])),{},{reset:function(){this.targetList=[],this.resetDesigner(),this.$refs.workPanel.clearAllModuleList()},resetData:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.moduleList,i=t.configMap,this.reset(),e.next=4,this.setData({moduleList:n,configMap:i});case 4:this.$refs.configPage.resetData();case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),setData:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,i,a,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=t.moduleList,i=t.configMap,this.updateConfigMap({key:this.code,configMap:i}),!(n&&n.length>0)){e.next=11;break}a=0;case 4:if(!(a<n.length)){e.next=11;break}return r=n[a],e.next=8,this.$refs.workPanel.addModuleObj(r,a);case 8:a++,e.next=4;break;case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),validateConfigMap:function(){var e=this;return new Promise((function(t,n){var i=e.$store.state.panelDesigner[e.code].moduleConfigMap,a=[];if(v.a.forEach(i,(function(e){a.push(e.mark)})),0===a.length)return t(),!1;var r=te(ee),o=[];if(r.forEach((function(e){if(!0!==e.unique)return!0;var t=a.filter((function(t){return e.mark===t}));t.length>1&&o.push(e.allName)})),0===o.length)return t(),!1;n(new Error("".concat(o.join("、")," 组件重复，请保持当前页面只有一个相同组件")))}))},windowResize:function(e){var t=!0===e?70:120,n=!0===e?500:546;this.workPanelHeight=window.innerHeight-t,this.workPanelMaxWidth=window.innerWidth-n}}),watch:{targetList:function(e,t){1!==t.length||2!==e.length||e[0].uuid||(e[0]=t[0]),this.$emit("change",e)}},computed:{currentModule:function(){return this.$store.state.panelDesigner[this.code].currentModule},configMapStr:function(){var e={moduleList:this.targetList,configMap:this.$store.state.panelDesigner[this.code].moduleConfigMap};return JSON.stringify(e)}},components:{draggable:u.a,"work-panel":X["a"],"config-page":Q},props:{code:{type:String,required:!0},projectType:{type:String,required:!0},initModuleMarkList:{type:Array,required:!1,default:void 0}},mounted:function(){this.$nextTick(Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!this.initModuleMarkList){e.next=9;break}t=0;case 2:if(!(t<this.initModuleMarkList.length)){e.next=9;break}return n=this.initModuleMarkList[t],e.next=6,this.$refs.workPanel.addModuleObj({mark:n},t);case 6:t++,e.next=2;break;case 9:case"end":return e.stop()}}),e,this)}))))},created:function(){this.windowResize(!1),window.addEventListener("resize",this.windowResize)},destroyed:function(){window.removeEventListener("resize",this.windowResize)}},ce=se,le=(n("e996"),Object(I["a"])(ce,s,c,!1,null,"5bb7d684",null)),ue=le.exports,de=n("3aa3"),pe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dir-selector"},[n("a-alert",{attrs:{message:"当前目录："+e.value,type:"success"}}),n("div",{staticClass:"tree-container"},[e.dirTree.length>0?n("a-directory-tree",{attrs:{"tree-data":e.dirTree,"replace-fields":{title:"name",key:"relativePath"},multiple:"","default-expand-all":""},on:{select:e.onTreeSelected}}):e._e()],1)],1)},fe=[],me={name:"DirSelector",data:function(){return{dirTree:[]}},methods:{initDirList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,de["a"].get("/diboot/devtools/panelDesigner/getDirList");case 2:t=e.sent,0===t.code&&(this.dirTree=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onTreeSelected:function(e){e.length>0&&this.$emit("change",e[0])}},created:function(){this.initDirList()},model:{prop:"value",event:"change"},props:{value:{type:String,default:""}}},ge=me,he=(n("868f"),Object(I["a"])(ge,pe,fe,!1,null,null,null)),ve=he.exports,be={methods:{getPanelMethods:function(){var e=[],t=this.$store.state.panelDesigner.default.moduleConfigMap;return v.a.forEach(t,(function(t){t.scriptConfig&&t.scriptConfig.methods&&t.scriptConfig.methods.length>0&&e.push.apply(e,Object(g["a"])(t.scriptConfig.methods))})),e}}},ye={data:function(){return{sumCount:0,completeCount:0,workspace:"panelDesigner",notifyKey:"validateNotify",errs:[]}},methods:{startGlobalValidate:function(){this.sumCount=0,this.completeCount=0,this.errs=[];var e={};try{e=this.$store.state.panelDesigner.default.moduleConfigMap}catch(t){this.state.loading=!1,console.log("获取所有配置项出错",t)}if(this.sumCount=Object.keys(e).length,0===this.sumCount)return this.state.loading=!1,!1;y["a"].$emit("startConfigValidate")},completeGlobalValidate:function(){if(0===this.errs.length)return this.showNotification("校验完成","组件配置成功，正在提交..."),this.globalValidateSuccess(),!1;var e={};"panelDesigner"===this.workspace&&(e=ne(ee));var t="";this.errs.forEach((function(n){var i=e[n.mark];n.mark&&i&&(t+='<p style="font-weight: bold; color: #666; margin: 0;">'.concat(i.allName,'</p><p style="color: #f9686c; margin: 0;">').concat(n.err,"</p>"))})),this.showNotification("配置错误提示：",t,!0),console.log("校验完成",this.errs),this.state.loading=!1},validateComplete:function(e,t){this.completeCount++,this.showNotification("配置校验中...","正在校验第 ".concat(this.completeCount," 个组件配置！")),t&&this.errs.push({mark:e,err:t}),this.completeCount===this.sumCount&&this.completeGlobalValidate()},globalValidateSuccess:function(){},showNotification:function(e,t,n){var i,a=this,r=this;n&&(i=function(e){return e("a-button",{props:{type:"primary",size:"small"},on:{click:function(){return a.$notification.close(r.notifyKey)}}},"关闭")}),this.$notification.open({key:r.notifyKey,message:e,btn:i,description:function(e){return e("div",{domProps:{innerHTML:t}})}})}},created:function(){var e=this;y["a"].$on("validateComplete",(function(t){var n=t.mark,i=t.err;e.validateComplete(n,i)}))},destroyed:function(){y["a"].$off("validateComplete")}};function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){Object(r["a"])(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var we={name:"PanelDesignerIndex",data:function(){return{pane:{code:"default"},projectType:"",panelList:[],panelInfo:{id:void 0,name:"",code:"",dirPath:"src/views/panel",fileName:"",eventData:"",paramData:"",methodsData:""},panelInfoRules:{name:[{required:!0,message:"请填写面板名称",trigger:"blur"},{validator:this.checkPanelNameDuplicate,trigger:"blur"}],code:[{required:!0,message:"请填写面板编码",trigger:"blur"},{validator:this.checkPanelCodeValid,trigger:"blur"},{validator:this.checkPanelCodeDuplicate,trigger:"blur"}]},moduleListMap:{},state:{loading:!1}}},methods:{addModule:function(e){},removeModule:function(e){e.m,e.targetList},moduleListChanged:function(e,t){this.moduleListMap[e]=t},beforeGenerate:function(){this.state.loading=!0,y["a"].$emit("collectPanelEvents","submit")},generate:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.validate();case 2:this.startGlobalValidate();case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),globalValidateSuccess:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,i,a,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=v.a.cloneDeep(this.$store.state.panelDesigner.default),t.moduleList=this.moduleListMap.default,n=JSON.stringify(t),i=this.panelInfo.id,a={config:n,panelId:this.panelInfo.id,name:this.panelInfo.name,code:this.panelInfo.code,dirPath:this.panelInfo.dirPath,fileName:this.panelInfo.fileName,paramData:this.panelInfo.paramData,eventData:this.panelInfo.eventData,methodsData:this.panelInfo.methodsData},this.attachMainTableMap(t,a),this.state.loading=!0,de["a"].post("/diboot/devtools/panelDesigner/generate",a).then((function(e){if(r.state.loading=!1,0===e.code){var t="pop_".concat(Date.now());r.$notification.destroy(),r.$notification.success({message:"生成面板成功",description:"代码生成成功 (稍后将完成自动格式化)",duration:0,btn:function(e){return e("a-button",{props:{type:"primary",size:"small"},on:{click:function(){r.$notification.close(t),r.reset()}}},"确认")},key:t}),r.$emit("complete",e.data.id),r.initPanelList().then((function(){r.panelInfo.id=e.data.id})),window!==top&&parent.panelIframeComplete&&parent.panelIframeComplete({panelId:e.data.id,operateName:i===e.data.id?"编辑":"添加"})}})).catch((function(){r.state.loading=!1}));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),attachMainTableMap:function(e,t){if(e.moduleList&&0!==e.moduleList.length&&e.moduleConfigMap){var n={};e.moduleList.forEach((function(t){"treeList"===t.mark&&(n[t.mark]=e.moduleConfigMap[t.uuid].metadata.treeTable)})),t.mainTableMap=JSON.stringify(n)}},validate:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.validateForm();case 3:return e.next=5,this.$refs.pc_designer_default.validateConfigMap();case 5:this.state.loading=!1,e.next=14;break;case 8:throw e.prev=8,e.t0=e["catch"](0),this.state.loading=!1,t="pop_".concat(Date.now()),this.$notification.error({message:"校验未通过",description:e.t0.message,duration:0,btn:function(e){return e("a-button",{props:{type:"primary",size:"small"},on:{click:function(){return n.$notification.close(t)}}},"关闭")},key:t}),e.t0;case 14:case"end":return e.stop()}}),e,this,[[0,8]])})));function t(){return e.apply(this,arguments)}return t}(),validateForm:function(){var e=this;return new Promise((function(t,n){e.$refs.panelInfoForm.validate((function(e){e?t():n(new Error("请完善表单项"))}))}))},getPanelParamData:function(){var e=this.moduleListMap.default;if(!e||0===e.length)return"";var t=e.find((function(e){return"panelProps"===e.mark}));if(void 0===t||!t.uuid)return"";var n=this.$store.state.panelDesigner.default.moduleConfigMap[t.uuid];if(void 0===n)return"";var i=n.metadata.propConfigList;return JSON.stringify(i)},validateModuleList:function(){var e=this,t=this.moduleListMap.default,n=t.forEach((function(t){var n="".concat(e.pane.code,"_config_").concat(t.uuid),i=e.$refs[n].getValidateMsg;return{uuid:t.uuid,msg:i}}));console.log(n)},checkPanelNameDuplicate:function(e,t,n){if(t){var i={id:this.panelInfo.id,panelName:t};de["a"].get("/diboot/devtools/panelDesigner/checkPanelNameDuplicate",i).then((function(e){0===e.code?n():n(new Error(e.msg.split(":")[1]))})).catch((function(e){n(new Error(e))}))}else n()},checkPanelCodeValid:function(e,t,n){if(t){var i=/([A-Za-z])([a-z0-9]+)$/;i.test(t)?n():n(new Error("请使用驼峰命名法进行命名"))}else n()},checkPanelCodeDuplicate:function(e,t,n){if(t){var i={id:this.panelInfo.id,panelCode:t};de["a"].get("/diboot/devtools/panelDesigner/checkPanelCodeDuplicate",i).then((function(e){0===e.code?n():n(new Error(e.msg.split(":")[1]))})).catch((function(e){n(new Error(e))}))}else n()},initPanelList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,de["a"].get("/diboot/devtools/panelDesigner/getPanelList");case 2:t=e.sent,0===t.code&&(this.panelList=t.data);case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),onPanelChanged:function(e){var t=this.panelList.find((function(t){return t.id===e}));void 0!==t&&(this.panelInfo.id=t.id,this.panelInfo.name=t.panelName,this.panelInfo.code=t.panelCode,this.panelInfo.dirPath=t.dirPath,this.panelInfo.fileName=t.panelCode,this.resetDesignerConfig(t.configData))},resetDesignerConfig:function(e){if(e){var t=JSON.parse(e),n=v.a.cloneDeep(t.moduleList),i=t.moduleConfigMap;this.$refs["pc_designer_".concat(this.pane.code)].resetData({moduleList:n,configMap:i})}},getProjectType:function(){var e=this;de["a"].getWithoutMsg("/diboot/devtools/pcDesigner/projectType").then((function(t){0===t.code?e.projectType=t.data:e.$notification.warning({message:"前端配置提示",description:t.msg&&t.msg.includes(":")?t.msg.split(":")[1]:t.msg})}))},reset:function(){window.location.reload()},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}},computed:ke({},Object(b["f"])({previewBtnGroupAlign:function(e){return e.customProperties.designer.previewBtnGroupAlign}})),components:{designer:ue,dirSelector:ve},mixins:[be,ye],created:function(){var e=this;this.initPanelList(),this.getProjectType(),this.$store.commit("INIT_DESINGER_CONFIG"),y["a"].$on("collectPanelEventsComplete",(function(t){var n=t.emitEventList,i=t.type;if("submit"===i){var a=JSON.stringify(n);e.panelInfo.eventData=a;var r=e.getPanelParamData();e.panelInfo.paramData=r,e.panelInfo.methodsData=JSON.stringify(e.getPanelMethods()),e.generate()}}))}},Me=we,_e=Object(I["a"])(Me,i,a,!1,null,null,null);t["default"]=_e.exports},a71d:function(e,t,n){},d39e:function(e,t,n){"use strict";n("a71d")},d980:function(e,t,n){},e996:function(e,t,n){"use strict";n("f911")},f014:function(e,t,n){"use strict";n("d980")},f911:function(e,t,n){}}]);