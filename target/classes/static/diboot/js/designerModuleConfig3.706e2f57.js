(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["designerModuleConfig3"],{"0ef1":function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-form",{attrs:{layout:"horizontal"}},[n("h3",{staticClass:"title separator"},[t._v("基础配置")]),n("a-form-model",{attrs:{layout:"horizontal"}},[n("a-form-model-item",{attrs:{label:"布局列数",labelCol:{span:6},wrapperCol:{span:18}}},[n("a-input-number",{attrs:{min:1,max:10,placeholder:"请输入布局列数"},model:{value:t.moduleConfig.metadata.colNumber,callback:function(e){t.$set(t.moduleConfig.metadata,"colNumber",e)},expression:"moduleConfig.metadata.colNumber"}})],1)],1),n("column-list-selector-plus",{attrs:{"primary-key-event":!0,"need-ref-entity":!1,"valid-columns-filter":t.validColumnsFilter,title:"表单项配置","is-expand":!0,"col-extra-properties-setter":t.setColExtraProperties,"expand-columns-filter":t.expandColumnsFilter},on:{change:function(e){t.moduleConfig.metadata.columns=t._.cloneDeep(e)},primaryKeyChange:function(e){t.moduleConfig.metadata.primaryKey=e}},scopedSlots:t._u([{key:"item-extra-content",fn:function(e){var i=e.col;return[i.columnExt&&"M_FILE_UPLOAD"!==i.columnExt.formType&&"S_FILE_UPLOAD"!==i.columnExt.formType&&"M_IMG_UPLOAD"!==i.columnExt.formType&&"S_IMG_UPLOAD"!==i.columnExt.formType&&"RICH_EDITOR"!==i.columnExt.formType?n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"设置"}},[n("a-checkbox",{model:{value:i.disableUpdate,callback:function(e){t.$set(i,"disableUpdate",e)},expression:"col.disableUpdate"}},[t._v("\n          该字段禁止更新\n        ")])],1):t._e(),n("a-form-item",{staticStyle:{"margin-bottom":"0"},attrs:{labelCol:{span:6},wrapperCol:{span:17},label:"事件"}},[n("a-radio-group",{on:{change:function(e){return t.onColActionTypeChange(e.target.value,i)}},model:{value:i.actionType,callback:function(e){t.$set(i,"actionType",e)},expression:"col.actionType"}},[n("a-radio",{attrs:{value:""}},[t._v("\n            无\n          ")]),n("a-radio",{attrs:{value:"btnPopWindow"}},[t._v("\n            按钮打开面板弹窗\n          ")])],1)],1),"btnPopWindow"===i.actionType?n("btn-pop-window-panel-selector",{attrs:{code:t.code,"project-type":t.projectType,"btn-window-data-list":t.btnWindowDataList,"panel-list":t.panelList,"extract-all-btn-window-methods":t.extractAllBtnWindowMethods,workspace:t.workspace},on:{change:t.onBtnWindowDataChange,updatePanelList:function(e){return t.panelList=e}},model:{value:i.btnWindowData,callback:function(e){t.$set(i,"btnWindowData",e)},expression:"col.btnWindowData"}}):t._e()]}}])})],1)},o=[],a=n("75fc"),l=(n("ac6a"),n("e5b5")),s=n("4047"),r=n("c5e9"),u=n("01bc"),c={name:"FormPanelConfig",data:function(){return{panelList:void 0}},methods:{setColExtraProperties:function(t){t.actionType="",t.btnWindowData=void 0,t.disableUpdate=!1},onColActionTypeChange:function(t,e){e.btnWindowData={}},onBtnWindowDataChange:function(){var t=this.moduleConfig.scriptConfig.methods.filter((function(t){return"panelExtractor"!==t.origin}));this.moduleConfig.metadata.columns.forEach((function(e){"btnPopWindow"===e.actionType&&e.btnWindowData&&e.btnWindowData.panelConfig&&e.btnWindowData.panelConfig.scriptConfig&&e.btnWindowData.panelConfig.scriptConfig.methods&&t.push.apply(t,Object(a["a"])(e.btnWindowData.panelConfig.scriptConfig.methods))})),this.moduleConfig.scriptConfig.methods=t},extractAllBtnWindowMethods:function(){return Object(u["a"])(this.btnWindowDataList)},expandColumnsFilter:function(t){return!0},validColumnsFilter:function(t){return"id"!==t.fieldName&&"uuid"!==t.fieldName&&"isDeleted"!==t.fieldName&&"extdata"!==t.fieldName&&"createTime"!==t.fieldName&&"updateTime"!==t.fieldName&&"createBy"!==t.fieldName&&"updateBy"!==t.fieldName}},computed:{btnWindowDataList:function(){return this.moduleConfig.metadata.columns&&0!==this.moduleConfig.metadata.columns.length?this.moduleConfig.metadata.columns.filter((function(t){return"btnPopWindow"===t.actionType})).map((function(t){return t.btnWindowData})):[]}},mixins:[l["a"]],components:{columnListSelectorPlus:s["a"],btnPopWindowPanelSelector:r["a"]}},d=c,m=(n("2741"),n("2877")),p=Object(m["a"])(d,i,o,!1,null,"48df4a9a",null);e["default"]=p.exports},2741:function(t,e,n){"use strict";n("34bf")},"34bf":function(t,e,n){},4047:function(t,e,n){"use strict";var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("h3",{staticClass:"title separator"},[t._v("\n    "+t._s(t.title)+"\n    "),n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",ghost:"",size:"small",title:"更改所有的显示标签",icon:"edit"},on:{click:t.showAllEdit}})],1),[t.resultColumns?n("draggable",{attrs:{element:"div",handle:".drag-handle",options:{group:{name:"columns",pull:"false",put:!1},sort:!0,forceFallback:!0}},model:{value:t.resultColumns,callback:function(e){t.resultColumns=e},expression:"resultColumns"}},t._l(t.resultColumns,(function(e,i){return n("div",{key:i,staticClass:"row-container"},[n("a-row",{staticClass:"config-form-item"},[n("a-col",{attrs:{span:2}},[n("span",{staticClass:"col-icon-span drag-handle",attrs:{title:"拖拽可排序"}},[n("a-icon",{staticStyle:{fontSize:"20px"},attrs:{type:"bars"}})],1)]),n("a-col",{attrs:{span:t._f("anotherColSpan")(t._f("btnColSpan")(4,e,t.isExpand,t.expandColumnsFilter),2)}},[e.showInput?n("a-input",{attrs:{id:t.voType+"FieldNameEditInput_"+e.fieldName,size:"small"},on:{keyup:[function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"enter",13,n.key,"Enter")?null:t.saveEdit(e)},function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"esc",27,n.key,["Esc","Escape"])?null:t.cancelEdit(e)}]},model:{value:e.editFieldLabel,callback:function(n){t.$set(e,"editFieldLabel",n)},expression:"col.editFieldLabel"}},[n("template",{slot:"addonAfter"},[n("a-icon",{staticStyle:{cursor:"pointer"},attrs:{type:"close",title:"关闭"},on:{click:function(n){return t.cancelEdit(e)}}}),n("a-divider",{attrs:{type:"vertical"}}),n("a-icon",{staticStyle:{color:"#2198f7",cursor:"pointer"},attrs:{type:"check",title:"保存"},on:{click:function(n){return t.saveEdit(e)}}})],1)],2):n("p",{staticClass:"icon-small-line"},[n("span",{staticStyle:{"padding-right":"2px"}},[t._v("\n                "+t._s(e.fieldLabel)+"\n              ")]),"BindEntity"===e.refCodeType?n("a-tag",{attrs:{color:"cyan"}},[t._v("\n                对象.字段\n              ")]):t._e(),"BindFieldList"===e.refCodeType?n("a-tag",{attrs:{color:"blue"}},[t._v("\n                对象字段列表\n              ")]):t._e()],1)],1),n("a-col",{staticStyle:{"text-align":"right"},attrs:{span:t._f("btnColSpan")(4,e,t.isExpand,t.expandColumnsFilter)}},[e.showInput?t._e():n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",size:"small",title:"更改该项显示标签",icon:"edit"},on:{click:function(n){return t.showEdit(e)}}}),t.isExpand&&(void 0===t.expandColumnsFilter||t.expandColumnsFilter(e))?n("a-button",{staticStyle:{color:"#777"},attrs:{type:"link",size:"small",title:e.expand?"收起":"展开",icon:e.expand?"up":"down"},on:{click:function(n){return t.toggleColExpand(e)}}}):t._e(),n("a-button",{staticStyle:{color:"#f36e70"},attrs:{type:"link",size:"small",title:"删除该项",icon:"delete"},on:{click:function(e){return t.removeColumn(i)}}})],1)],1),e.expand?[n("div",{staticClass:"expand-container"},[t._t("item-extra-content",null,{col:e,index:i})],2)]:t._e()],2)})),0):t._e(),n("a-row",[n("a-col",{attrs:{span:"22"}},[t.selectColumns.length>0?n("a-select",{staticStyle:{width:"100%"},attrs:{"show-search":"","filter-option":t.filterOption,placeholder:"请选择搜索字段"},on:{change:function(e){return t.addColumn(e)}},model:{value:t.addFieldName,callback:function(e){t.addFieldName=e},expression:"addFieldName"}},t._l(t.selectColumns,(function(e,i){return n("a-select-option",{key:i,attrs:{value:e.fieldName}},[t._v("\n            "+t._s(e.fieldLabel)+"["+t._s(e.fieldName)+"]\n          ")])})),1):t._e()],1)],1)]],2)},o=[],a=(n("6762"),n("2fdb"),n("ac6a"),n("75fc")),l=(n("7514"),n("2ef0")),s=n.n(l),r=n("3aa3"),u=n("310e"),c=n.n(u),d={name:"ColumnListSelectorPlus",data:function(){return{resultColumns:[],validColumns:[],addFieldName:void 0,showAllEditFlag:!1}},methods:{initPrimaryKey:function(){if(!this.primaryKeyEvent||!this.columns||0===this.columns.length)return!1;var t=this.columns.find((function(t){return!0===t.primaryKey})),e=void 0===t?"id":t.fieldName;this.$emit("primaryKeyChange",e)},initValidColumns:function(){var t=this;if(this.columns&&this.columns.length>0){var e=this.columns;if(void 0!==this.validColumnsFilter&&(e=this.columns.filter(this.validColumnsFilter)),this.validColumns=s.a.cloneDeep(e),this.appendOtherProperties(this.validColumns),this.voType){var n=this.columns[0]["tableName"];r["a"].get("/diboot/devtools/pcDesigner/getVoRefList/".concat(n,"/").concat(this.voType)).then((function(e){if(0===e.code&&e.data){var n,i=e.data.filter((function(t){return"BindEntity"!==t.refCodeType&&"BindEntityList"!==t.refCodeType}));if(t.appendOtherProperties(i),(n=t.validColumns).push.apply(n,Object(a["a"])(i)),t.value.length>0?t.resultColumns=s.a.cloneDeep(t.value):t.resultColumns=s.a.cloneDeep(t.validColumns),t.needRefEntity){var o,l=e.data.filter((function(t){return"BindEntity"===t.refCodeType&&void 0!==t.columns&&t.columns.length>0})),r=[];l.forEach((function(t){var e=t.columns.filter((function(t){return"id"!==t.fieldName&&"isDeleted"!==t.fieldName&&"extdata"!==t.fieldName&&!t.columnExt.refType})),n=e.map((function(e){return e.fieldName="".concat(t.fieldName,".").concat(e.fieldName),e.fieldLabel="".concat(t.fieldLabel).concat(e.fieldLabel),e.refCodeType=t.refCodeType,e.entityFieldName=t.fieldName,e}));r.push.apply(r,Object(a["a"])(n))})),t.appendOtherProperties(r),(o=t.validColumns).push.apply(o,r)}}else t.value.length>0?t.resultColumns=s.a.cloneDeep(t.value):t.resultColumns=s.a.cloneDeep(t.validColumns)})).catch((function(){t.value.length>0?t.resultColumns=s.a.cloneDeep(t.value):t.resultColumns=s.a.cloneDeep(t.validColumns)}))}else this.value.length>0?this.resultColumns=s.a.cloneDeep(this.value):this.resultColumns=s.a.cloneDeep(this.validColumns)}},addColumn:function(t){var e=this.validColumns.find((function(e){return e.fieldName===t}));if(void 0===e)return!1;this.addFieldName=void 0,this.resultColumns.push(e),this.$emit("change",this.resultColumns)},toggleColExpand:function(t){t.expand=!t.expand},removeColumn:function(t){var e=this.resultColumns.splice(t,1);if(e.length>0){var n=e[0],i=this.validColumns.find((function(t){return t.colName===n.colName}));if(void 0!==i){var o=this.validColumns.indexOf(i);-1!==o&&(this.validColumns[o]=n)}}this.$emit("change",this.resultColumns)},appendOtherProperties:function(t){var e=this;t.forEach((function(t){t.showInput=!1,t.expand=!1,t.editFieldLabel=t.fieldLabel,void 0!==e.colExtraPropertiesSetter&&e.colExtraPropertiesSetter(t)}))},showAllEdit:function(){var t=this;this.showAllEditFlag=!this.showAllEditFlag,this.resultColumns&&this.resultColumns.map((function(e){t.showAllEditFlag?e.showInput=!0:t.cancelEdit(e)}))},showEdit:function(t){var e=this;t.showInput=!0,setTimeout((function(){var n=document.getElementById("".concat(e.voType,"FieldNameEditInput_").concat(t.fieldName));n&&n.focus()}),200)},cancelEdit:function(t){t.editFieldLabel=t.fieldLabel,t.showInput=!1,this.focusNextColumn(t)},saveEdit:function(t){if(!t.editFieldLabel)return this.$message.error("字段标签名称不可为空"),!1;t.fieldLabel=t.editFieldLabel,t.showInput=!1,this.$emit("change",this.resultColumns),this.$forceUpdate(),this.focusNextColumn(t)},focusNextColumn:function(t){var e=this.resultColumns.indexOf(t)+1;if(e>0&&e<this.resultColumns.length){var n=this.resultColumns[e];n.showInput?document.getElementById("".concat(this.voType,"FieldNameEditInput_").concat(n.fieldName)).focus():this.focusNextColumn(n)}},changed:function(){this.$emit("change",this.resultColumns)},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0}},filters:{btnColSpan:function(t,e,n,i){return t=t||4,n&&(t+=2),void 0===i||i(e)||(t-=2),e.showInput||(t+=2),t},anotherColSpan:function(t,e){return 24-t-e}},computed:{columns:function(){return this.initColumns?this.initColumns:this.$store.state.database.columns},selectColumns:function(){if(void 0===this.resultColumns)return[];var t=this.resultColumns.map((function(t){return t.fieldName}));return this.validColumns.filter((function(e){return!t.includes(e.fieldName)}))}},watch:{columns:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()},resultColumns:{handler:function(t){this.$emit("change",t)},deep:!0}},components:{draggable:c.a},props:{title:{type:String,default:"数据项配置"},isExpand:{type:Boolean,default:!0},voType:{type:String,default:""},value:{type:Array,default:function(){return[]}},colExtraPropertiesSetter:{type:Function,default:function(){}},expandColumnsFilter:{type:Function,default:void 0},validColumnsFilter:{type:Function,default:void 0},needRefEntity:{type:Boolean,default:!0},initColumns:{type:Array,default:void 0},primaryKeyEvent:{type:Boolean,default:!1}},created:function(){this.validColumns=[],this.resultColumns=[],this.initValidColumns(),this.initPrimaryKey()}},m=d,p=(n("ea8f"),n("2877")),f=Object(p["a"])(m,i,o,!1,null,"8f19bbea",null);e["a"]=f.exports},"5b70":function(t,e,n){"use strict";n("cdb0")},7201:function(t,e,n){},ab09:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"tableOperateConfig"},[n("operate-line-config",{attrs:{"project-type":t.projectType,code:t.code},model:{value:t.moduleConfig,callback:function(e){t.moduleConfig=e},expression:"moduleConfig"}})],1)},o=[],a=n("7f57"),l=n("a5d1"),s={name:"OperateLineConfig",mixins:[a["a"]],components:{operateLineConfig:l["a"]}},r=s,u=(n("5b70"),n("2877")),c=Object(u["a"])(r,i,o,!1,null,"34bd9a59",null);e["default"]=c.exports},cdb0:function(t,e,n){},ea8f:function(t,e,n){"use strict";n("7201")}}]);