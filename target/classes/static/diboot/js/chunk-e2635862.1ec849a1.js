(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e2635862"],{"172f":function(e,t,a){},"17a3":function(e,t,a){"use strict";a("a723")},"1d91":function(e,t,a){},"297c":function(e,t,a){"use strict";a("b532")},"2d6f":function(e,t,a){},"2e22":function(e,t,a){"use strict";a("1d91")},"41e6":function(e,t,a){},7138:function(e,t,a){"use strict";a("c0fd")},"760e":function(e,t,a){"use strict";a("aed3")},9531:function(e,t,a){},"9d4a":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"db-dields-wrap"},[e.columnsPageMsg.show?a("a-alert",{attrs:{message:e.columnsPageMsg.title,type:e.columnsPageMsg.type,closable:""},on:{close:function(t){e.columnsPageMsg.show=!1}}},[a("p",{attrs:{slot:"description"},domProps:{innerHTML:e._s(e.columnsPageMsg.message)},slot:"description"})]):e._e(),e.showDragTips?a("a-alert",{attrs:{closable:"",type:"warning",showIcon:""}},[a("span",{attrs:{slot:"message"},slot:"message"},[e._v("请使用 "),a("b",[e._v("Chrome浏览器")]),e._v(" 拖拽排序!")])]):e._e(),a("table",{staticClass:"db-dields"},[e._m(0),a("draggable",{attrs:{element:"tbody",handle:".drag-handle",options:{group:{name:"columns",pull:"false",put:!1},sort:!0,forceFallback:!0}},model:{value:e.columns,callback:function(t){e.columns=t},expression:"columns"}},e._l(e.columns,(function(t,n){return a("tr",{key:n,class:{"primary-col":t.primaryKey}},[a("td",{staticClass:"center"},[a("a-button-group",[e.showDragBtn?a("a-button",{staticClass:"drag-handle",attrs:{type:"primary",disabled:e.disabledDragBtn,size:"small",title:"拖拽排序"}},[a("a-icon",{attrs:{type:"drag"}})],1):e._e(),a("a-button",{attrs:{size:"small",type:"normal",title:"删除该行",disabled:e.isDisabled(t)},on:{click:function(t){return e.deleteRow(n)}}},[a("a-icon",{attrs:{type:"minus"}})],1),a("a-button",{attrs:{size:"small",title:"在下方添加一行"},on:{click:function(t){return e.addNewRow(n)}}},[a("a-icon",{attrs:{type:"plus"}})],1)],1)],1),a("td",[a("a-input",{staticClass:"w-min-100",staticStyle:{padding:"4px 5px"},attrs:{placeholder:"字段名",disabled:e.isDisabled(t)},on:{blur:function(a){return e.onColNameBlur(t)}},model:{value:t.colName,callback:function(a){e.$set(t,"colName",a)},expression:"item.colName"}})],1),a("td",[a("a-input",{staticClass:"w-min-80",attrs:{placeholder:"备注 (名词)",disabled:e.isDisabled(t)},model:{value:t.fieldLabel,callback:function(a){e.$set(t,"fieldLabel",a)},expression:"item.fieldLabel"}})],1),a("td",[a("a-select",{staticClass:"w-min-100",attrs:{defaultValue:"String",placeholder:"数据类型",showSearch:!0,filterOption:e.filterOption,disabled:e.isDisabled(t)},on:{change:function(a){return e.onFieldPackagingTypeChanged(t)}},model:{value:t.fieldPackagingType,callback:function(a){e.$set(t,"fieldPackagingType",a)},expression:"item.fieldPackagingType"}},e._l(e.codeDataTypeList,(function(t){return a("a-select-option",{key:t.dataType,attrs:{value:t.dataType}},[e._v(e._s(t.name)+"\n            ")])})),1)],1),a("td",[a("a-input",{staticClass:"w-50",staticStyle:{padding:"4px"},attrs:{placeholder:"长度",disabled:e.isDisabled(t)},on:{blur:function(a){return e.onColLengthBlur(t)}},model:{value:t.colLength,callback:function(a){e.$set(t,"colLength",a)},expression:"item.colLength"}})],1),a("td",[t.fieldPackagingType?a(t.fieldPackagingType+"Attr",{tag:"component",attrs:{readonly:e.isDisabled(t)},on:{change:function(a){return e.onExtensionMapChange(t,a)}},model:{value:t.extensionMap,callback:function(a){e.$set(t,"extensionMap",a)},expression:"item.extensionMap"}}):e._e()],1),a("td",{staticClass:"center"},[a("a-checkbox",{attrs:{disabled:t.primaryKey||t.colName&&("is_deleted"===t.colName||"create_time"===t.colName)||!t.editable},model:{value:t.notnull,callback:function(a){e.$set(t,"notnull",a)},expression:"item.notnull"}})],1),a("td",[a("a-tooltip",{attrs:{placement:"top",title:t.defaultValue}},[a("a-input",{staticClass:"w-min-70",attrs:{placeholder:"默认值",disabled:e.isDisabled(t)},model:{value:t.defaultValue,callback:function(a){e.$set(t,"defaultValue",a)},expression:"item.defaultValue"}})],1)],1),a("td",[a("a-select",{staticClass:"w-min-150",attrs:{placeholder:"表单类型",showSearch:!0,filterOption:e.filterOption,disabled:t.colName&&("is_deleted"===t.colName||"create_time"===t.colName)},on:{change:function(a){return e.onFormTypeChange(t,a)}},model:{value:t.columnExt.formType,callback:function(a){e.$set(t.columnExt,"formType",a)},expression:"item.columnExt.formType"}},[e._l(e.codeDataTypeList,(function(n){return[n.dataType===t.fieldPackagingType?[e._l(n.formDataTypeList,(function(n){return[t.columnExt.refType&&"S_SELECT"!==n.code?e._e():a("a-select-option",{key:n.code,attrs:{value:n.code}},[e._v("\n                    "+e._s(n.name)+"\n                  ")])]}))]:e._e()]})),a("a-select-option",{attrs:{value:"NONE"}},[e._v("忽略不显示")])],2)],1),a("td",{staticClass:"ref-select-td"},[a("ref-config-index",{attrs:{item:t,readonly:e.isDisabled(t)}})],1),a("td",["T"===t.columnExt.refType&&t.columnExt.refTable&&t.columnExt.refColumn&&t.columnExt.asColumn&&void 0!==e.tableDataListMap[t.columnExt.refTable]?a("a-select",{staticClass:"w-min-120",attrs:{defaultValue:""},model:{value:t.example,callback:function(a){e.$set(t,"example",a)},expression:"item.example"}},[a("a-select-option",{attrs:{value:""}},[e._v("-关联数据-")]),e._l(e.tableDataListMap[t.columnExt.refTable],(function(n){return a("a-select-option",{key:""+n[t.columnExt.refColumn],attrs:{value:""+n[t.columnExt.refColumn]}},[e._v("\n              "+e._s(n[t.columnExt.asColumn])+"\n            ")])}))],2):"T"===t.columnExt.refType?a("a-select",{staticClass:"w-120",attrs:{defaultValue:""}},[a("a-select-option",{attrs:{value:""}},[e._v("-关联数据-")])],1):"D"===t.columnExt.refType&&t.columnExt.refColumn&&void 0!==e.dictDataListMap[t.columnExt.refColumn]?a("a-select",{staticClass:"w-120",attrs:{defaultValue:""},model:{value:t.example,callback:function(a){e.$set(t,"example",a)},expression:"item.example"}},[a("a-select-option",{attrs:{value:""}},[e._v("-字典数据-")]),e._l(e.dictDataListMap[t.columnExt.refColumn],(function(t){return a("a-select-option",{key:t.v,attrs:{value:t.v}},[e._v("\n              "+e._s(t.k)+"\n            ")])}))],2):"D"===t.columnExt.refType?a("a-select",{staticClass:"w-120",attrs:{defaultValue:""}},[a("a-select-option",{attrs:{value:""}},[e._v("-字典数据-")])],1):"DATEPICKER"===t.columnExt.formType||"DATETIMEPICKER"===t.columnExt.formType?a("a-date-picker",{staticClass:"w-120",attrs:{disabled:"NONE"===t.columnExt.formType,placeholder:"选择日期",format:"YYYY-MM-DD"},model:{value:t.example,callback:function(a){e.$set(t,"example",a)},expression:"item.example"}}):"Boolean"===t.fieldPackagingType?a("a-switch",{staticClass:"w-50",staticStyle:{width:"50px",float:"left"},attrs:{disabled:"NONE"===t.columnExt.formType},model:{value:t.example,callback:function(a){e.$set(t,"example",a)},expression:"item.example"}},[a("a-icon",{attrs:{slot:"checkedChildren",type:"check"},slot:"checkedChildren"}),a("a-icon",{attrs:{slot:"unCheckedChildren",type:"close"},slot:"unCheckedChildren"})],1):a("a-input",{staticClass:"w-120",attrs:{disabled:"NONE"===t.columnExt.formType,placeholder:"样例数据"},model:{value:t.example,callback:function(a){e.$set(t,"example",a)},expression:"item.example"}})],1)])})),0)],1),a("dictionary-modal",{ref:"dictModal"})],1)},i=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",{attrs:{width:"40"}},[e._v("操作")]),a("th",[e._v("字段名")]),a("th",[e._v("备注")]),a("th",[e._v("数据类型")]),a("th",[e._v("长度")]),a("th",[e._v("扩展配置")]),a("th",[e._v("非空")]),a("th",[e._v("默认值")]),a("th",[e._v("表单类型")]),a("th",[e._v("关联")]),a("th",[e._v("样例数据")])])])}],l=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),o=(a("2fdb"),a("4917"),a("6762"),a("a481"),a("2f62")),s=a("310e"),r=a.n(s),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"添加数据字典",visible:e.state.visible,okText:"确定",cancelText:"取消"},on:{ok:e.onSubmit,cancel:e.close}},[a("a-form",{attrs:{layout:"vertical",form:e.form}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"类型名称"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["itemName",{initialValue:e.dict.itemName,rules:[{required:!0,message:"类型名称不能为空",whitespace:!0}]}],expression:"[\n              'itemName',\n              {\n                initialValue: dict.itemName,\n                rules: [{ required: true, message: '类型名称不能为空', whitespace: true }]\n              }\n            ]"}],attrs:{placeholder:"字典类型名称"}})],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"类型编码"}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{initialValue:e.dict.type,rules:[{required:!0,message:"类型编码不能为空",whitespace:!0},{validator:this.typeValidator}]}],expression:"[\n              'type',\n              {\n                initialValue: dict.type,\n                rules: [{ required: true, message: '类型编码不能为空', whitespace: true }, { validator: this.typeValidator }]\n              }\n            ]"}],attrs:{placeholder:"字典类型编码(大写英文字母)"}})],1)],1)],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"包含子项"}},[e.children.length>0?a("a-row",{attrs:{gutter:16}},[a("a-col",{staticStyle:{"margin-left":"-15px"},attrs:{span:24}},[e._l(e.children,(function(t,n){return[a("a-tag",{directives:[{name:"decorator",rawName:"v-decorator",value:["children",{initialValue:e.children,rules:[{required:!0,message:"子项不能为空"}]}],expression:"[\n                    'children',\n                    {\n                      initialValue: children,\n                      rules: [{ required: true, message: '子项不能为空'}]\n                    }\n                  ]"}],key:n,style:{padding:"5px",margin:"5px 15px",height:"30px",lineHeight:"16px"},attrs:{closable:"",color:"blue"},on:{click:function(a){return e.onTagClicked(t,n)},close:function(t){return e.onTagClosed(t,n)}}},[e._v("\n                  "+e._s(t.itemName)+"("+e._s(t.itemValue)+")\n                ")])]}))],2)],1):e._e(),a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:8}},[a("a-input",{attrs:{placeholder:"子项名称"},model:{value:e.childItem.itemName,callback:function(t){e.$set(e.childItem,"itemName",t)},expression:"childItem.itemName"}})],1),a("a-col",{attrs:{span:8}},[a("a-input",{attrs:{placeholder:"子项编码"},model:{value:e.childItem.itemValue,callback:function(t){e.$set(e.childItem,"itemValue",t)},expression:"childItem.itemValue"}})],1),a("a-col",{attrs:{span:8}},[a("a-button",{attrs:{type:e.childrenBtnConfig.type},on:{click:e.handleSubItem}},[e._v(e._s(e.childrenBtnConfig.label))])],1)],1)],1)],1)],1),a("a-row",{directives:[{name:"show",rawName:"v-show",value:e.children&&e.children.length>0&&!e.childItem.itemName&&!e.childItem.itemValue,expression:"children && children.length > 0 && !childItem.itemName && !childItem.itemValue"}],attrs:{gutter:16}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"拖拽排序"}},[a("draggable",{attrs:{element:"span"},model:{value:e.children,callback:function(t){e.children=t},expression:"children"}},e._l(e.children,(function(t,n){return a("a-tag",{key:n,staticClass:"draggable-element",attrs:{color:"blue"}},[e._v("\n              "+e._s(t.itemName)+"("+e._s(t.itemValue)+")\n            ")])})),1)],1)],1)],1),a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"备注"}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["description",{initialValue:e.dict.description}],expression:"[\n              'description',\n              {\n                initialValue: dict.description\n              }\n            ]"}],attrs:{rows:5,placeholder:"备注"}})],1)],1)],1)],1)],1)},m=[],u=(a("28a5"),a("96cf"),a("3b8d")),d=a("2abb"),p=a("3aa3"),f=a("2ef0"),h=a.n(f),b={editing:!1,type:"primary",label:"添加子项",currentIndex:void 0},x={id:"",itemName:"",itemValue:""},g={name:"DictionaryModal",data:function(){return{state:{visible:!1,submitBtn:!1},form:this.$form.createForm(this),dict:{},children:[],childItem:h.a.cloneDeep(x),childrenBtnConfig:h.a.cloneDeep(b)}},methods:{open:function(){this.state.visible=!0},close:function(){this.state.visible=!1,this.dict={},this.children=[],this.form.resetFields()},onTagClicked:function(e,t){return this.childItem.id=e.id,this.childItem.itemName=e.itemName,this.childItem.itemValue=e.itemValue,this.childrenBtnConfig={label:"更新子项",type:"dashed",editing:!0,currentIndex:t},!1},onTagClosed:function(e,t){e.stopPropagation(),this.children.length>t&&this.children.splice(t,1),e.preventDefault()},handleSubItem:function(){return""===this.childItem.itemName?(this.$message.error("请输入数据字典子项名称"),!1):""===this.childItem.itemValue?(this.$message.error("请输入数据字典子项编码"),!1):(void 0===this.childrenBtnConfig.currentIndex||this.childrenBtnConfig.currentIndex>=this.children.length?this.children.push(this.childItem):(this.children[this.childrenBtnConfig.currentIndex].id=this.childItem.id,this.children[this.childrenBtnConfig.currentIndex].itemName=this.childItem.itemName,this.children[this.childrenBtnConfig.currentIndex].itemValue=this.childItem.itemValue),this.childItem=h.a.cloneDeep(x),void(this.childrenBtnConfig=h.a.cloneDeep(b)))},validate:function(){var e=this;return new Promise((function(t,a){e.form.validateFields((function(n,i){n?a(n):t(i),setTimeout((function(){e.state.submitBtn=!1}),600)}))}))},onSubmit:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(){var t,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.state.submitBtn=!0,e.next=3,this.validate();case 3:return t=e.sent,this.enhance(t),e.prev=5,e.next=8,this.add(t);case 8:a=e.sent,this.submitSuccess(a),e.next=15;break;case 12:e.prev=12,e.t0=e["catch"](5),this.submitFailed(e.t0);case 15:case"end":return e.stop()}}),e,this,[[5,12]])})));function t(){return e.apply(this,arguments)}return t}(),submitSuccess:function(e){this.$notification.success({message:"操作成功",description:e}),this.close(),this.form.resetFields(),this.$store.dispatch("setDictionaryList",!0)},submitFailed:function(e){e&&e.msg&&this.$notification.error({message:"操作失败",description:e.msg})},enhance:function(e){e.children=this.children},add:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,d["a"].post("/diboot/devtools/dict/addItems",t);case 2:if(a=e.sent,0!==a.code){e.next=8;break}return this.$emit("complete",a.data),e.abrupt("return","添加数据字典成功");case 8:throw new Error(a.msg);case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),typeValidator:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t,a,n){var i,l,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a){e.next=3;break}return n(),e.abrupt("return");case 3:if(i=/^[a-zA-Z]{1}([a-zA-Z]*_?[a-zA-Z]+)*[a-zA-Z]*$/,!a||i.test(a)){e.next=8;break}n("请使用字母和下划线命名，不能以下划线开始和结束，且不能使用连续的下划线连接"),e.next=13;break;case 8:return l={type:a},e.next=11,p["a"].getWithoutMsg("/diboot/devtools/dict/checkType",l);case 11:o=e.sent,o&&0===o.code?n():n(o.msg.split(":")[1]);case 13:case"end":return e.stop()}}),e)})));function t(t,a,n){return e.apply(this,arguments)}return t}()},components:{draggable:r.a}},y=g,v=(a("da23"),a("2877")),_=Object(v["a"])(y,c,m,!1,null,"75308662",null),T=_.exports,E=a("5324"),C=a("6243"),N=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-checkbox-group",{on:{change:e.configListChanged},model:{value:e.extJson.configList,callback:function(t){e.$set(e.extJson,"configList",t)},expression:"extJson.configList"}},[a("a-checkbox",{attrs:{disabled:e.readonly,title:"固定长度(char)",value:"fixed"}},[e._v("\n      char\n    ")]),a("a-checkbox",{attrs:{disabled:e.readonly,title:"支持模糊查询",value:"like"}},[e._v("\n      LIKE\n    ")])],1)],1)},w=[],k={model:{prop:"extJson",event:"change"},props:{readonly:{type:Boolean,default:!1},extJson:{type:Object,default:function(){return{}}}}},L={name:"StringAttr",methods:{configListChanged:function(e){this.extJson.configList=e,this.$forceUpdate(),this.$emit("change",this.extJson)}},created:function(){this.extJson.configList||this.configListChanged([])},mixins:[k]},O=L,D=(a("17a3"),Object(v["a"])(O,N,w,!1,null,"98ce865c",null)),M=D.exports,$=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-input",{staticClass:"w-100",staticStyle:{width:"60px","margin-right":"5px"},attrs:{type:"text",readonly:e.readonly,placeholder:"小数点位数",title:"小数点位数"},on:{change:function(t){return e.decimalChanged(t.data)}},model:{value:e.extJson.decimal,callback:function(t){e.$set(e.extJson,"decimal",t)},expression:"extJson.decimal"}})],1)},j=[],B={name:"BigDecimalAttr",methods:{decimalChanged:function(e){this.extJson.decimal=e,this.$forceUpdate(),this.$emit("change",this.extJson)}},mounted:function(){void 0===this.extJson.decimal&&this.decimalChanged("2")},mixins:[k]},I=B,P=(a("7138"),Object(v["a"])(I,$,j,!1,null,"50225200",null)),R=P.exports,S=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},F=[],V={name:"BooleanAttr",data:function(){return{}},mixins:[k]},A=V,J=(a("fc3c"),Object(v["a"])(A,S,F,!1,null,"2456874a",null)),K=J.exports,z=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-select",{staticClass:"w-180",staticStyle:{padding:"4px 5px"},attrs:{disabled:e.readonly,title:"日期格式"},on:{change:e.formatterChanged},model:{value:e.extJson.formatter,callback:function(t){e.$set(e.extJson,"formatter",t)},expression:"extJson.formatter"}},e._l(e.formatterList,(function(t){return a("a-select-option",{key:t.val,attrs:{value:t.val}},[e._v("\n      "+e._s(t.label)+"\n    ")])})),1)],1)},q=[],H={name:"DateAttr",data:function(){return{formatterList:[{label:"yyyy-MM-dd HH:mm",val:"yyyy-MM-dd HH:mm"},{label:"yyyy-MM-dd",val:"yyyy-MM-dd"}]}},methods:{formatterChanged:function(e){this.extJson.formatter=e,this.$forceUpdate(),this.$emit("change",this.extJson)}},mounted:function(){void 0===this.extJson.formatter&&this.formatterChanged("yyyy-MM-dd HH:mm")},mixins:[k]},U=H,Y=(a("297c"),Object(v["a"])(U,z,q,!1,null,"f24d317e",null)),Z=Y.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},W=[],Q={name:"DoubleAttr",data:function(){return{}},mixins:[k]},X=Q,ee=(a("2e22"),Object(v["a"])(X,G,W,!1,null,"545a07c2",null)),te=ee.exports,ae=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},ne=[],ie={name:"IntegerAttr",data:function(){return{}},mixins:[k]},le=ie,oe=(a("9fc4"),Object(v["a"])(le,ae,ne,!1,null,"05ff40c4",null)),se=oe.exports,re=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},ce=[],me={name:"LongAttr",data:function(){return{}},mixins:[k]},ue=me,de=(a("c177"),Object(v["a"])(ue,re,ce,!1,null,"343c9fbc",null)),pe=de.exports,fe=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"refConfigContainer"},[e.enabled?[e._v("\n    无关联\n  ")]:a("a-popover",{attrs:{title:"关联配置 ( "+e.item.colName+" )",trigger:"click",placement:"left"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[a("a-form",{staticClass:"refConfigForm",staticStyle:{width:"520px","min-height":"140px"},attrs:{slot:"content","label-col":{span:4},"wrapper-col":{span:20}},slot:"content"},[a("a-form-item",{attrs:{label:"关联类型"}},[a("a-radio-group",{staticStyle:{width:"100%"},attrs:{defaultValue:"item.columnExt.refType",buttonStyle:"solid"},on:{change:function(t){return e.changeRefType(e.item)}},model:{value:e.item.columnExt.refType,callback:function(t){e.$set(e.item.columnExt,"refType",t)},expression:"item.columnExt.refType"}},[a("a-radio-button",{style:{width:e.item.primaryKey||!e.item.primaryKey&&"String"!==e.item.fieldPackagingType?"50%":"33%",textAlign:"center"},attrs:{value:""}},[e._v("无关联")]),a("a-radio-button",{style:{width:e.item.primaryKey||!e.item.primaryKey&&"String"!==e.item.fieldPackagingType?"50%":"33%",textAlign:"center"},attrs:{value:"T"}},[e._v("数据表")]),e.item.primaryKey||"String"!==e.item.fieldPackagingType?e._e():a("a-radio-button",{style:{width:"33%",textAlign:"center"},attrs:{value:"D"}},[e._v("数据字典")])],1)],1),"T"===e.item.columnExt.refType?a("a-form-item",{attrs:{label:"关联关系"}},[a("a-select",{attrs:{disabled:e.item.colName&&"uuid"==e.item.colName.toLowerCase()&&e.item.primaryKey||!e.item.editable},on:{change:function(t){return e.changeRelationship(e.item)}},model:{value:e.item.columnExt.refRelationship,callback:function(t){e.$set(e.item.columnExt,"refRelationship",t)},expression:"item.columnExt.refRelationship"}},[a("a-select-option",{attrs:{value:""}},[e._v("-请选择关联关系-")]),e.item.primaryKey?e._e():a("a-select-option",{attrs:{value:"1-1"}},[e._v("1-1")]),e.item.primaryKey?e._e():a("a-select-option",{attrs:{value:"n-1"}},[e._v("n-1")]),e.item.primaryKey?a("a-select-option",{attrs:{value:"n-n"}},[e._v("n-n（中间表）")]):e._e()],1)],1):e._e(),"T"===e.item.columnExt.refType?a("a-form-item",{attrs:{label:"关联配置"}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:"12"}},[a("a-select",{attrs:{"show-search":!0,"filter-option":e.filterOption,disabled:e.item.colName&&"uuid"==e.item.colName.toLowerCase()&&e.item.primaryKey||!e.item.editable},on:{change:function(t){return e.changeRefTable(e.item)}},model:{value:e.item.columnExt.refTable,callback:function(t){e.$set(e.item.columnExt,"refTable",t)},expression:"item.columnExt.refTable"}},[a("a-select-option",{attrs:{value:""}},[e._v("-请选择关联表-")]),e._l(e.tables,(function(t){return a("a-select-option",{key:t.tableName,attrs:{value:t.tableName,title:t.tableName}},[e._v("\n                "+e._s(t.tableName)+" ["+e._s(t.objName)+"]\n              ")])}))],2)],1),void 0!==e.item.columnExt.refTable?a("a-col",{attrs:{span:"12"}},[a("a-select",{attrs:{"show-search":!0,"filter-option":e.filterOption,disabled:e.item.colName&&"uuid"==e.item.colName.toLowerCase()&&e.item.primaryKey||!e.item.editable},on:{change:function(t){return e.onTableRefColumnChanged(e.item)}},model:{value:e.item.columnExt.refColumn,callback:function(t){e.$set(e.item.columnExt,"refColumn",t)},expression:"item.columnExt.refColumn"}},[a("a-select-option",{attrs:{value:""}},[e._v("-请选择关联的字段-")]),e._l(e.tableColumnsMap[e.item.columnExt.refTable],(function(t){return[t.fieldPackagingType===e.item.fieldPackagingType?a("a-select-option",{key:t.colName,attrs:{value:t.colName,title:t.colName}},[e._v("\n                  "+e._s(t.colName)+"["+e._s(t.fieldLabel)+"]\n                ")]):e._e()]}))],2)],1):e._e()],1)],1):e._e(),"T"===e.item.columnExt.refType&&e.item.primaryKey?a("a-form-item",{attrs:{label:"中间表名"}},[a("a-input",{attrs:{placeholder:"请输入中间表名",disabled:e.middleTableNameDisabled},model:{value:e.item.extensionMap.middleTableName,callback:function(t){e.$set(e.item.extensionMap,"middleTableName",t)},expression:"item.extensionMap.middleTableName"}})],1):e._e(),"T"!==e.item.columnExt.refType||void 0===e.item.columnExt.refTable||"n-n"===e.item.columnExt.refRelationship||e.item.primaryKey?e._e():a("a-form-item",{attrs:{label:"显示字段"}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:"12"}},[a("a-select",{attrs:{"show-search":!0,"filter-option":e.filterOption,disabled:e.item.colName&&"uuid"==e.item.colName.toLowerCase()&&e.item.primaryKey||!e.item.editable},on:{change:function(t){return e.onAsColumnChanged(e.item)}},model:{value:e.item.columnExt.asColumn,callback:function(t){e.$set(e.item.columnExt,"asColumn",t)},expression:"item.columnExt.asColumn"}},[a("a-select-option",{attrs:{value:""}},[e._v("-请选择显示的字段-")]),e._l(e.tableColumnsMap[e.item.columnExt.refTable],(function(t){return["String"===t.fieldPackagingType?a("a-select-option",{key:t.colName,attrs:{value:t.colName,title:t.colName}},[e._v("\n                  "+e._s(t.colName)+"["+e._s(t.fieldLabel)+"]\n                ")]):e._e()]}))],2)],1),a("a-col",{attrs:{span:12}},[a("a-input",{attrs:{placeholder:"显示字段属性名"},model:{value:e.item.extensionMap.showFieldName,callback:function(t){e.$set(e.item.extensionMap,"showFieldName",t)},expression:"item.extensionMap.showFieldName"}})],1)],1)],1),"T"===e.item.columnExt.refType&&"n-1"===e.item.columnExt.refRelationship||"1-1"===e.item.columnExt.refRelationship?a("a-form-item",{directives:[{name:"permission",rawName:"v-permission",value:["on_target_bind"],expression:"['on_target_bind']"}],attrs:{label:"实体绑定"}},[a("a-checkbox-group",{staticClass:"custom-checkbox-group",staticStyle:{width:"100%"},model:{value:e.item.columnExt.objectBindList,callback:function(t){e.$set(e.item.columnExt,"objectBindList",t)},expression:"item.columnExt.objectBindList"}},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{span:12}},[a("a-checkbox",{staticClass:"custom-checkbox",attrs:{value:"REF_TARGET_BIND_LIST"}},[a("a-tooltip",{attrs:{placement:"left"}},[a("template",{slot:"title"},[e._v("\n                    在"),e.item.columnExt.refTable?a("span",[e._v(" "+e._s(e.item.columnExt.refTable)+" ")]):a("span",[e._v("关联表")]),e._v("中绑定该实体"+e._s("n-1"===e.item.columnExt.refRelationship?"列表":"")+"\n                  ")]),a("span",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"185px",display:"block"}},[e._v("\n                    在"),e.item.columnExt.refTable?a("span",[e._v(" "+e._s(e.item.columnExt.refTable)+" ")]):a("span",[e._v("关联表")]),e._v("中绑定该实体"+e._s("n-1"===e.item.columnExt.refRelationship?"列表":"")+"\n                  ")])],2)],1)],1),a("a-col",{attrs:{span:12}},[a("a-input",{attrs:{disabled:e.item.currentTableName===e.item.columnExt.refTable,title:e.item.currentTableName===e.item.columnExt.refTable?"自关联使用children，用于构建树结构":"",placeholder:"实体列表属性名"},model:{value:e.item.extensionMap.refTargetBindListFieldName,callback:function(t){e.$set(e.item.extensionMap,"refTargetBindListFieldName",t)},expression:"item.extensionMap.refTargetBindListFieldName"}})],1)],1),a("a-row",{attrs:{gutter:[16,8]}},[a("a-col",{attrs:{span:12}},[a("a-checkbox",{staticClass:"custom-checkbox",attrs:{value:"SELF_BIND_OBJECT",disabled:e.disabled}},[a("a-tooltip",{attrs:{placement:"left"}},[a("template",{slot:"title"},[a("span",[e._v("在当前对象中绑定"),e.item.columnExt.refTable?a("span",[e._v(" "+e._s(e.item.columnExt.refTable)+" ")]):a("span",[e._v("关联")]),e._v("实体")])]),a("span",{staticStyle:{overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",width:"185px",display:"block"}},[e._v("在当前对象中绑定"),e.item.columnExt.refTable?a("span",[e._v(" "+e._s(e.item.columnExt.refTable)+" ")]):a("span",[e._v("关联")]),e._v("实体\n                  ")])],2)],1)],1),a("a-col",{attrs:{span:12}},[a("a-input",{attrs:{placeholder:"关联实体属性名"},model:{value:e.item.extensionMap.selfBindObjectFieldName,callback:function(t){e.$set(e.item.extensionMap,"selfBindObjectFieldName",t)},expression:"item.extensionMap.selfBindObjectFieldName"}})],1)],1)],1)],1):e._e(),"D"===e.item.columnExt.refType?a("a-form-item",{attrs:{label:"数据字典"}},[a("a-select",{attrs:{"show-search":!0,"filter-option":e.filterOption,disabled:(e.item.colName&&"id"==e.item.colName.toLowerCase()||e.item.colName&&"uuid"==e.item.colName.toLowerCase())&&e.item.primaryKey||!e.item.editable},on:{change:function(t){return e.onDictRefColumnChanged(e.item)}},model:{value:e.item.columnExt.refColumn,callback:function(t){e.$set(e.item.columnExt,"refColumn",t)},expression:"item.columnExt.refColumn"}},[a("a-select-option",{attrs:{value:""}},[e._v("-请选择数据字典-")]),e.dictionaryList&&e.dictionaryList.length>0?e._l(e.dictionaryList,(function(t){return a("a-select-option",{key:t.type,attrs:{value:t.type,title:t.itemName}},[e._v("\n              "+e._s(t.itemName)+"\n            ")])})):e._e()],2)],1):e._e(),"D"===e.item.columnExt.refType?a("a-form-item",{attrs:{label:"操作"}},[a("a-button",{attrs:{block:"",type:"primary",size:"small"},on:{click:function(t){return e.openDictModal(e.item)}}},[a("a-icon",{attrs:{type:"plus"}}),e._v("\n          添加数据字典\n        ")],1)],1):e._e()],1),a("a-button",{style:e.item.columnExt.refType?"":{color:"#999"},attrs:{type:e.item.columnExt.refType?"primary":"dashed",icon:e.item.columnExt.refType?"T"===e.item.columnExt.refType?"table":"read":"setting",size:"small",ghost:!!e.item.columnExt.refType}},["T"===e.item.columnExt.refType?[e._v("\n        数据表\n      ")]:"D"===e.item.columnExt.refType?[e._v("\n        数据字典\n      ")]:[e._v("\n        无关联\n      ")]],2)],1),a("dictionary-modal",{ref:"dictModal",on:{complete:e.dictComplete}})],2)},he=[],be=a("77db");function xe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function ge(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(a),!0).forEach((function(t){Object(l["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var ye={name:"RefConfigIndex",data:function(){return{visible:!1,disabled:!1}},methods:{openDictModal:function(e){this.$refs.dictModal.open(e.colName),this.visible=!1},changeRefType:function(e){var t=e.columnExt;"D"===t.refType&&this.$store.dispatch("setDictionaryList"),t.refType?t.formType="S_SELECT":E["a"].match(e,"fieldPackagingType"),t.refTable="",t.refColumn="",t.asColumn="",t.refRelationship="",t.objectBindList=[],e.extensionMap={}},onTableRefColumnChanged:function(e){e.columnExt.refColumn&&this.$forceUpdate()},changeRelationship:function(e){e.columnExt.asColumn?(this.disabled=!1,e.columnExt.objectBindList=[]):(e.columnExt.objectBindList=["SELF_BIND_OBJECT"],this.disabled=!0);var t=e.columnExt.refTable;e.currentTableName||(e.currentTableName=e.tableName),e.currentTableName&&t&&("n-1"===e.columnExt.refRelationship?e.extensionMap.refTargetBindListFieldName=e.currentTableName===t?"children":"".concat(Object(be["b"])(e.currentTableName),"List"):"1-1"===e.columnExt.refRelationship&&(e.extensionMap.refTargetBindListFieldName="".concat(Object(be["b"])(e.currentTableName))))},changeRefTable:function(e){var t=e.columnExt.refTable;t&&this.$store.dispatch("updateTableColumns",t),e.currentTableName||(e.currentTableName=e.tableName),"n-1"===e.columnExt.refRelationship?e.extensionMap.refTargetBindListFieldName=e.currentTableName===t?"children":"".concat(Object(be["b"])(e.currentTableName),"List"):"1-1"===e.columnExt.refRelationship&&(e.extensionMap.refTargetBindListFieldName="".concat(Object(be["b"])(e.currentTableName))),e.extensionMap.selfBindObjectFieldName="".concat(Object(be["b"])(t)),e.extensionMap.showFieldName="",e.columnExt.refColumn="",e.columnExt.asColumn="",e.columnExt.objectBindList=["SELF_BIND_OBJECT"],this.disabled=!0,e.primaryKey&&(e.columnExt.oldRefTable===t?e.extensionMap.middleTableName=JSON.parse(e.columnExt.oldExtensions||"{}")["middleTableName"]:e.extensionMap.middleTableName="".concat(e.tableName,"_").concat(t))},onAsColumnChanged:function(e){e.currentTableName||(e.currentTableName=e.tableName),e.columnExt.asColumn&&e.currentTableName===e.columnExt.refTable?e.extensionMap.showFieldName="parent".concat(Object(be["c"])(e.columnExt.asColumn)):e.extensionMap.showFieldName=e.columnExt.asColumn?"".concat(Object(be["b"])(e.columnExt.refTable)).concat(Object(be["c"])(e.columnExt.asColumn)):"",e.columnExt.asColumn?(this.disabled=!1,e.columnExt.objectBindList=e.columnExt.objectBindList.filter((function(e){return"SELF_BIND_OBJECT"!==e}))):(e.columnExt.objectBindList.push("SELF_BIND_OBJECT"),this.disabled=!0),this.$store.dispatch("updateTableDataList",e.columnExt.refTable)},onDictRefColumnChanged:function(e){e.columnExt.refColumn&&this.$store.dispatch("updateDictDataList",e.columnExt.refColumn)},dictComplete:function(e){if(!e)return!1;this.item.columnExt.refColumn=e.type,this.onDictRefColumnChanged(this.item)},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}},computed:ge(ge({},Object(o["f"])({tables:function(e){return e.database.tables},tableColumnsMap:function(e){return e.database.tableColumnsMap},dictionaryList:function(e){return e.database.dictionaryList}})),{},{enabled:function(){return this.item.colName&&"uuid"===this.item.colName.toLowerCase()&&this.item.primaryKey||!this.item.editable||this.item.colName&&("is_deleted"===this.item.colName||"create_time"===this.item.colName)},middleTableNameDisabled:function(){return this.item.columnExt.oldExtensions&&JSON.parse(this.item.columnExt.oldExtensions||"{}")["middleTableName"]===this.item.extensionMap.middleTableName}}),props:{item:{type:Object,required:!0},readonly:{type:Boolean,default:!1}},components:{dictionaryModal:T}},ve=ye,_e=(a("760e"),Object(v["a"])(ve,fe,he,!1,null,"3dd5bbcf",null)),Te=_e.exports;function Ee(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Ce(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?Ee(Object(a),!0).forEach((function(t){Object(l["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):Ee(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var Ne=["id","uuid","create_time","is_deleted"],we={name:"FieldListIndex",data:function(){return{tableName:"",fieldTypeList:["String","Long","Integer","Boolean","Date","Double","BigDecimal"]}},methods:{onColNameBlur:function(e){if(e.colName=e.colName.replace(/ /g,""),e.colName&&Ne.includes(e.colName))return e.colName="",this.$message.warning("列表不可为内置字段名称"),!1;E["a"].match(e,this,"colName"),C["a"].validateColNameIsKeyword(e.colName)},onFieldPackagingTypeChanged:function(e){E["a"].match(e,"fieldPackagingType")},onColLengthBlur:function(e){E["a"].matchColLength(e,"colLength")},onAsColumnChanged:function(e){this.$store.dispatch("updateTableDataList",e.columnExt.refTable)},onExtensionMapChange:function(e,t){E["a"].matchColExtJson(e,t)},onFormTypeChange:function(e,t){E["a"].matchColFormType(e,t)},onDictRefColumnChanged:function(e){this.$store.dispatch("updateDictDataList",e.columnExt.refColumn)},addNewRow:function(e){this.$store.commit("addNewRow",e)},deleteRow:function(e){this.$store.commit("deleteRow",e)},isDisabled:function(e){return"string"===typeof e.primaryKey&&e.primaryKey.includes("true")||"boolean"===typeof e.primaryKey&&e.primaryKey||e.colName.length>0&&("is_deleted"===e.colName||"create_time"===e.colName)},filterOption:function(e,t){return t.componentOptions.children[0].text.toLowerCase().indexOf(e.toLowerCase())>=0}},computed:Ce(Ce({},Object(o["f"])({dbType:function(e){return e.database.dbType},tables:function(e){return e.database.tables},tableColumnsMap:function(e){return e.database.tableColumnsMap},codeDataTypeList:function(e){return e.database.codeDataTypeList},tableDataListMap:function(e){return e.database.tableDataListMap},dictDataListMap:function(e){return e.database.dictDataListMap},columnsPageMsg:function(e){return e.database.columnsPageMsg}})),{},{columns:{get:function(){return this.$store.state.database.columns},set:function(e){this.$store.commit("setColumns",e)}},showDragBtn:function(){return this.dbType&&("mysql"===this.dbType||"mariadb"===this.dbType)},disabledDragBtn:function(){return navigator.userAgent.indexOf("Chrome")<=0&&navigator.userAgent.indexOf("Firefox")<=0},showDragTips:function(){return this.showDragBtn&&this.disabledDragBtn}}),watch:{columns:function(e){this.$store.commit("setColumns",e)}},mounted:function(){this.$store.dispatch("getCodeDataTypeList")},components:{draggable:r.a,dictionaryModal:T,StringAttr:M,BigDecimalAttr:R,BooleanAttr:K,DateAttr:Z,DoubleAttr:te,IntegerAttr:se,LongAttr:pe,RefConfigIndex:Te}},ke=we,Le=(a("d6d9"),Object(v["a"])(ke,n,i,!1,null,"b13796f4",null));t["default"]=Le.exports},"9fc4":function(e,t,a){"use strict";a("bc72")},a723:function(e,t,a){},aed3:function(e,t,a){},b532:function(e,t,a){},bc72:function(e,t,a){},c0fd:function(e,t,a){},c177:function(e,t,a){"use strict";a("172f")},d6d9:function(e,t,a){"use strict";a("41e6")},da23:function(e,t,a){"use strict";a("2d6f")},fc3c:function(e,t,a){"use strict";a("9531")}}]);